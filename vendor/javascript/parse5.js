// parse5@8.0.0 downloaded from https://ga.jspm.io/npm:parse5@8.0.0/dist/index.js

import{EntityDecoder as e,htmlDecodeTree as t,DecodingMode as s}from"entities/decode";import{escapeAttribute as a,escapeText as n}from"entities/escape";const r=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]);const i="ï¿½";var o;(function(e){e[e.EOF=-1]="EOF";e[e.NULL=0]="NULL";e[e.TABULATION=9]="TABULATION";e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN";e[e.LINE_FEED=10]="LINE_FEED";e[e.FORM_FEED=12]="FORM_FEED";e[e.SPACE=32]="SPACE";e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK";e[e.QUOTATION_MARK=34]="QUOTATION_MARK";e[e.AMPERSAND=38]="AMPERSAND";e[e.APOSTROPHE=39]="APOSTROPHE";e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS";e[e.SOLIDUS=47]="SOLIDUS";e[e.DIGIT_0=48]="DIGIT_0";e[e.DIGIT_9=57]="DIGIT_9";e[e.SEMICOLON=59]="SEMICOLON";e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN";e[e.EQUALS_SIGN=61]="EQUALS_SIGN";e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN";e[e.QUESTION_MARK=63]="QUESTION_MARK";e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A";e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z";e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET";e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT";e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A";e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(o||(o={}));const c={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function E(e){return e>=55296&&e<=57343}function T(e){return e>=56320&&e<=57343}function _(e,t){return 1024*(e-55296)+9216+t}function h(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function A(e){return e>=64976&&e<=65007||r.has(e)}var l;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream";e.noncharacterInInputStream="noncharacter-in-input-stream";e.surrogateInInputStream="surrogate-in-input-stream";e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus";e.endTagWithAttributes="end-tag-with-attributes";e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus";e.unexpectedSolidusInTag="unexpected-solidus-in-tag";e.unexpectedNullCharacter="unexpected-null-character";e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name";e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name";e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name";e.missingEndTagName="missing-end-tag-name";e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name";e.unknownNamedCharacterReference="unknown-named-character-reference";e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference";e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier";e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value";e.eofBeforeTagName="eof-before-tag-name";e.eofInTag="eof-in-tag";e.missingAttributeValue="missing-attribute-value";e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes";e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword";e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers";e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword";e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier";e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier";e.missingDoctypePublicIdentifier="missing-doctype-public-identifier";e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier";e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier";e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier";e.cdataInHtmlContent="cdata-in-html-content";e.incorrectlyOpenedComment="incorrectly-opened-comment";e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text";e.eofInDoctype="eof-in-doctype";e.nestedComment="nested-comment";e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment";e.eofInComment="eof-in-comment";e.incorrectlyClosedComment="incorrectly-closed-comment";e.eofInCdata="eof-in-cdata";e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference";e.nullCharacterReference="null-character-reference";e.surrogateCharacterReference="surrogate-character-reference";e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range";e.controlCharacterReference="control-character-reference";e.noncharacterCharacterReference="noncharacter-character-reference";e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name";e.missingDoctypeName="missing-doctype-name";e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name";e.duplicateAttribute="duplicate-attribute";e.nonConformingDoctype="non-conforming-doctype";e.missingDoctype="missing-doctype";e.misplacedDoctype="misplaced-doctype";e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element";e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements";e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head";e.openElementsLeftAfterEof="open-elements-left-after-eof";e.abandonedHeadElementChild="abandoned-head-element-child";e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element";e.nestedNoscriptInHead="nested-noscript-in-head";e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(l||(l={}));const m=65536;class Preprocessor{constructor(e){this.handler=e;this.html="";this.pos=-1;this.lastGapPos=-2;this.gapStack=[];this.skipNextNewLine=false;this.lastChunkWritten=false;this.endOfChunkHit=false;this.bufferWaterline=m;this.isEol=false;this.lineStartPos=0;this.droppedBufferSize=0;this.line=1;this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e,t){const{line:s,col:a,offset:n}=this;const r=a+t;const i=n+t;return{code:e,startLine:s,endLine:s,startCol:r,endCol:r,startOffset:i,endOffset:i}}_err(e){if(this.handler.onParseError&&this.lastErrOffset!==this.offset){this.lastErrOffset=this.offset;this.handler.onParseError(this.getError(e,0))}}_addGap(){this.gapStack.push(this.lastGapPos);this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const t=this.html.charCodeAt(this.pos+1);if(T(t)){this.pos++;this._addGap();return _(e,t)}}else if(!this.lastChunkWritten){this.endOfChunkHit=true;return o.EOF}this._err(l.surrogateInInputStream);return e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){if(this.willDropParsedChunk()){this.html=this.html.substring(this.pos);this.lineStartPos-=this.pos;this.droppedBufferSize+=this.pos;this.pos=0;this.lastGapPos=-2;this.gapStack.length=0}}write(e,t){this.html.length>0?this.html+=e:this.html=e;this.endOfChunkHit=false;this.lastChunkWritten=t}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1);this.endOfChunkHit=false}startsWith(e,t){if(this.pos+e.length>this.html.length){this.endOfChunkHit=!this.lastChunkWritten;return false}if(t)return this.html.startsWith(e,this.pos);for(let t=0;t<e.length;t++){const s=this.html.charCodeAt(this.pos+t)|32;if(s!==e.charCodeAt(t))return false}return true}peek(e){const t=this.pos+e;if(t>=this.html.length){this.endOfChunkHit=!this.lastChunkWritten;return o.EOF}const s=this.html.charCodeAt(t);return s===o.CARRIAGE_RETURN?o.LINE_FEED:s}advance(){this.pos++;if(this.isEol){this.isEol=false;this.line++;this.lineStartPos=this.pos}if(this.pos>=this.html.length){this.endOfChunkHit=!this.lastChunkWritten;return o.EOF}let e=this.html.charCodeAt(this.pos);if(e===o.CARRIAGE_RETURN){this.isEol=true;this.skipNextNewLine=true;return o.LINE_FEED}if(e===o.LINE_FEED){this.isEol=true;if(this.skipNextNewLine){this.line--;this.skipNextNewLine=false;this._addGap();return this.advance()}}this.skipNextNewLine=false;E(e)&&(e=this._processSurrogate(e));const t=this.handler.onParseError===null||e>31&&e<127||e===o.LINE_FEED||e===o.CARRIAGE_RETURN||e>159&&e<64976;t||this._checkForProblematicCharacters(e);return e}_checkForProblematicCharacters(e){h(e)?this._err(l.controlCharacterInInputStream):A(e)&&this._err(l.noncharacterInInputStream)}retreat(e){this.pos-=e;while(this.pos<this.lastGapPos){this.lastGapPos=this.gapStack.pop();this.pos--}this.isEol=false}}var p;(function(e){e[e.CHARACTER=0]="CHARACTER";e[e.NULL_CHARACTER=1]="NULL_CHARACTER";e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER";e[e.START_TAG=3]="START_TAG";e[e.END_TAG=4]="END_TAG";e[e.COMMENT=5]="COMMENT";e[e.DOCTYPE=6]="DOCTYPE";e[e.EOF=7]="EOF";e[e.HIBERNATION=8]="HIBERNATION"})(p||(p={}));function I(e,t){for(let s=e.attrs.length-1;s>=0;s--)if(e.attrs[s].name===t)return e.attrs[s].value;return null}var N=Object.freeze(Object.defineProperty({__proto__:null,get TokenType(){return p},getTokenAttr:I},Symbol.toStringTag,{value:"Module"}));var d;(function(e){e.HTML="http://www.w3.org/1999/xhtml";e.MATHML="http://www.w3.org/1998/Math/MathML";e.SVG="http://www.w3.org/2000/svg";e.XLINK="http://www.w3.org/1999/xlink";e.XML="http://www.w3.org/XML/1998/namespace";e.XMLNS="http://www.w3.org/2000/xmlns/"})(d||(d={}));var u;(function(e){e.TYPE="type";e.ACTION="action";e.ENCODING="encoding";e.PROMPT="prompt";e.NAME="name";e.COLOR="color";e.FACE="face";e.SIZE="size"})(u||(u={}));var C;(function(e){e.NO_QUIRKS="no-quirks";e.QUIRKS="quirks";e.LIMITED_QUIRKS="limited-quirks"})(C||(C={}));var S;(function(e){e.A="a";e.ADDRESS="address";e.ANNOTATION_XML="annotation-xml";e.APPLET="applet";e.AREA="area";e.ARTICLE="article";e.ASIDE="aside";e.B="b";e.BASE="base";e.BASEFONT="basefont";e.BGSOUND="bgsound";e.BIG="big";e.BLOCKQUOTE="blockquote";e.BODY="body";e.BR="br";e.BUTTON="button";e.CAPTION="caption";e.CENTER="center";e.CODE="code";e.COL="col";e.COLGROUP="colgroup";e.DD="dd";e.DESC="desc";e.DETAILS="details";e.DIALOG="dialog";e.DIR="dir";e.DIV="div";e.DL="dl";e.DT="dt";e.EM="em";e.EMBED="embed";e.FIELDSET="fieldset";e.FIGCAPTION="figcaption";e.FIGURE="figure";e.FONT="font";e.FOOTER="footer";e.FOREIGN_OBJECT="foreignObject";e.FORM="form";e.FRAME="frame";e.FRAMESET="frameset";e.H1="h1";e.H2="h2";e.H3="h3";e.H4="h4";e.H5="h5";e.H6="h6";e.HEAD="head";e.HEADER="header";e.HGROUP="hgroup";e.HR="hr";e.HTML="html";e.I="i";e.IMG="img";e.IMAGE="image";e.INPUT="input";e.IFRAME="iframe";e.KEYGEN="keygen";e.LABEL="label";e.LI="li";e.LINK="link";e.LISTING="listing";e.MAIN="main";e.MALIGNMARK="malignmark";e.MARQUEE="marquee";e.MATH="math";e.MENU="menu";e.META="meta";e.MGLYPH="mglyph";e.MI="mi";e.MO="mo";e.MN="mn";e.MS="ms";e.MTEXT="mtext";e.NAV="nav";e.NOBR="nobr";e.NOFRAMES="noframes";e.NOEMBED="noembed";e.NOSCRIPT="noscript";e.OBJECT="object";e.OL="ol";e.OPTGROUP="optgroup";e.OPTION="option";e.P="p";e.PARAM="param";e.PLAINTEXT="plaintext";e.PRE="pre";e.RB="rb";e.RP="rp";e.RT="rt";e.RTC="rtc";e.RUBY="ruby";e.S="s";e.SCRIPT="script";e.SEARCH="search";e.SECTION="section";e.SELECT="select";e.SOURCE="source";e.SMALL="small";e.SPAN="span";e.STRIKE="strike";e.STRONG="strong";e.STYLE="style";e.SUB="sub";e.SUMMARY="summary";e.SUP="sup";e.TABLE="table";e.TBODY="tbody";e.TEMPLATE="template";e.TEXTAREA="textarea";e.TFOOT="tfoot";e.TD="td";e.TH="th";e.THEAD="thead";e.TITLE="title";e.TR="tr";e.TRACK="track";e.TT="tt";e.U="u";e.UL="ul";e.SVG="svg";e.VAR="var";e.WBR="wbr";e.XMP="xmp"})(S||(S={}));var D;(function(e){e[e.UNKNOWN=0]="UNKNOWN";e[e.A=1]="A";e[e.ADDRESS=2]="ADDRESS";e[e.ANNOTATION_XML=3]="ANNOTATION_XML";e[e.APPLET=4]="APPLET";e[e.AREA=5]="AREA";e[e.ARTICLE=6]="ARTICLE";e[e.ASIDE=7]="ASIDE";e[e.B=8]="B";e[e.BASE=9]="BASE";e[e.BASEFONT=10]="BASEFONT";e[e.BGSOUND=11]="BGSOUND";e[e.BIG=12]="BIG";e[e.BLOCKQUOTE=13]="BLOCKQUOTE";e[e.BODY=14]="BODY";e[e.BR=15]="BR";e[e.BUTTON=16]="BUTTON";e[e.CAPTION=17]="CAPTION";e[e.CENTER=18]="CENTER";e[e.CODE=19]="CODE";e[e.COL=20]="COL";e[e.COLGROUP=21]="COLGROUP";e[e.DD=22]="DD";e[e.DESC=23]="DESC";e[e.DETAILS=24]="DETAILS";e[e.DIALOG=25]="DIALOG";e[e.DIR=26]="DIR";e[e.DIV=27]="DIV";e[e.DL=28]="DL";e[e.DT=29]="DT";e[e.EM=30]="EM";e[e.EMBED=31]="EMBED";e[e.FIELDSET=32]="FIELDSET";e[e.FIGCAPTION=33]="FIGCAPTION";e[e.FIGURE=34]="FIGURE";e[e.FONT=35]="FONT";e[e.FOOTER=36]="FOOTER";e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT";e[e.FORM=38]="FORM";e[e.FRAME=39]="FRAME";e[e.FRAMESET=40]="FRAMESET";e[e.H1=41]="H1";e[e.H2=42]="H2";e[e.H3=43]="H3";e[e.H4=44]="H4";e[e.H5=45]="H5";e[e.H6=46]="H6";e[e.HEAD=47]="HEAD";e[e.HEADER=48]="HEADER";e[e.HGROUP=49]="HGROUP";e[e.HR=50]="HR";e[e.HTML=51]="HTML";e[e.I=52]="I";e[e.IMG=53]="IMG";e[e.IMAGE=54]="IMAGE";e[e.INPUT=55]="INPUT";e[e.IFRAME=56]="IFRAME";e[e.KEYGEN=57]="KEYGEN";e[e.LABEL=58]="LABEL";e[e.LI=59]="LI";e[e.LINK=60]="LINK";e[e.LISTING=61]="LISTING";e[e.MAIN=62]="MAIN";e[e.MALIGNMARK=63]="MALIGNMARK";e[e.MARQUEE=64]="MARQUEE";e[e.MATH=65]="MATH";e[e.MENU=66]="MENU";e[e.META=67]="META";e[e.MGLYPH=68]="MGLYPH";e[e.MI=69]="MI";e[e.MO=70]="MO";e[e.MN=71]="MN";e[e.MS=72]="MS";e[e.MTEXT=73]="MTEXT";e[e.NAV=74]="NAV";e[e.NOBR=75]="NOBR";e[e.NOFRAMES=76]="NOFRAMES";e[e.NOEMBED=77]="NOEMBED";e[e.NOSCRIPT=78]="NOSCRIPT";e[e.OBJECT=79]="OBJECT";e[e.OL=80]="OL";e[e.OPTGROUP=81]="OPTGROUP";e[e.OPTION=82]="OPTION";e[e.P=83]="P";e[e.PARAM=84]="PARAM";e[e.PLAINTEXT=85]="PLAINTEXT";e[e.PRE=86]="PRE";e[e.RB=87]="RB";e[e.RP=88]="RP";e[e.RT=89]="RT";e[e.RTC=90]="RTC";e[e.RUBY=91]="RUBY";e[e.S=92]="S";e[e.SCRIPT=93]="SCRIPT";e[e.SEARCH=94]="SEARCH";e[e.SECTION=95]="SECTION";e[e.SELECT=96]="SELECT";e[e.SOURCE=97]="SOURCE";e[e.SMALL=98]="SMALL";e[e.SPAN=99]="SPAN";e[e.STRIKE=100]="STRIKE";e[e.STRONG=101]="STRONG";e[e.STYLE=102]="STYLE";e[e.SUB=103]="SUB";e[e.SUMMARY=104]="SUMMARY";e[e.SUP=105]="SUP";e[e.TABLE=106]="TABLE";e[e.TBODY=107]="TBODY";e[e.TEMPLATE=108]="TEMPLATE";e[e.TEXTAREA=109]="TEXTAREA";e[e.TFOOT=110]="TFOOT";e[e.TD=111]="TD";e[e.TH=112]="TH";e[e.THEAD=113]="THEAD";e[e.TITLE=114]="TITLE";e[e.TR=115]="TR";e[e.TRACK=116]="TRACK";e[e.TT=117]="TT";e[e.U=118]="U";e[e.UL=119]="UL";e[e.SVG=120]="SVG";e[e.VAR=121]="VAR";e[e.WBR=122]="WBR";e[e.XMP=123]="XMP"})(D||(D={}));const O=new Map([[S.A,D.A],[S.ADDRESS,D.ADDRESS],[S.ANNOTATION_XML,D.ANNOTATION_XML],[S.APPLET,D.APPLET],[S.AREA,D.AREA],[S.ARTICLE,D.ARTICLE],[S.ASIDE,D.ASIDE],[S.B,D.B],[S.BASE,D.BASE],[S.BASEFONT,D.BASEFONT],[S.BGSOUND,D.BGSOUND],[S.BIG,D.BIG],[S.BLOCKQUOTE,D.BLOCKQUOTE],[S.BODY,D.BODY],[S.BR,D.BR],[S.BUTTON,D.BUTTON],[S.CAPTION,D.CAPTION],[S.CENTER,D.CENTER],[S.CODE,D.CODE],[S.COL,D.COL],[S.COLGROUP,D.COLGROUP],[S.DD,D.DD],[S.DESC,D.DESC],[S.DETAILS,D.DETAILS],[S.DIALOG,D.DIALOG],[S.DIR,D.DIR],[S.DIV,D.DIV],[S.DL,D.DL],[S.DT,D.DT],[S.EM,D.EM],[S.EMBED,D.EMBED],[S.FIELDSET,D.FIELDSET],[S.FIGCAPTION,D.FIGCAPTION],[S.FIGURE,D.FIGURE],[S.FONT,D.FONT],[S.FOOTER,D.FOOTER],[S.FOREIGN_OBJECT,D.FOREIGN_OBJECT],[S.FORM,D.FORM],[S.FRAME,D.FRAME],[S.FRAMESET,D.FRAMESET],[S.H1,D.H1],[S.H2,D.H2],[S.H3,D.H3],[S.H4,D.H4],[S.H5,D.H5],[S.H6,D.H6],[S.HEAD,D.HEAD],[S.HEADER,D.HEADER],[S.HGROUP,D.HGROUP],[S.HR,D.HR],[S.HTML,D.HTML],[S.I,D.I],[S.IMG,D.IMG],[S.IMAGE,D.IMAGE],[S.INPUT,D.INPUT],[S.IFRAME,D.IFRAME],[S.KEYGEN,D.KEYGEN],[S.LABEL,D.LABEL],[S.LI,D.LI],[S.LINK,D.LINK],[S.LISTING,D.LISTING],[S.MAIN,D.MAIN],[S.MALIGNMARK,D.MALIGNMARK],[S.MARQUEE,D.MARQUEE],[S.MATH,D.MATH],[S.MENU,D.MENU],[S.META,D.META],[S.MGLYPH,D.MGLYPH],[S.MI,D.MI],[S.MO,D.MO],[S.MN,D.MN],[S.MS,D.MS],[S.MTEXT,D.MTEXT],[S.NAV,D.NAV],[S.NOBR,D.NOBR],[S.NOFRAMES,D.NOFRAMES],[S.NOEMBED,D.NOEMBED],[S.NOSCRIPT,D.NOSCRIPT],[S.OBJECT,D.OBJECT],[S.OL,D.OL],[S.OPTGROUP,D.OPTGROUP],[S.OPTION,D.OPTION],[S.P,D.P],[S.PARAM,D.PARAM],[S.PLAINTEXT,D.PLAINTEXT],[S.PRE,D.PRE],[S.RB,D.RB],[S.RP,D.RP],[S.RT,D.RT],[S.RTC,D.RTC],[S.RUBY,D.RUBY],[S.S,D.S],[S.SCRIPT,D.SCRIPT],[S.SEARCH,D.SEARCH],[S.SECTION,D.SECTION],[S.SELECT,D.SELECT],[S.SOURCE,D.SOURCE],[S.SMALL,D.SMALL],[S.SPAN,D.SPAN],[S.STRIKE,D.STRIKE],[S.STRONG,D.STRONG],[S.STYLE,D.STYLE],[S.SUB,D.SUB],[S.SUMMARY,D.SUMMARY],[S.SUP,D.SUP],[S.TABLE,D.TABLE],[S.TBODY,D.TBODY],[S.TEMPLATE,D.TEMPLATE],[S.TEXTAREA,D.TEXTAREA],[S.TFOOT,D.TFOOT],[S.TD,D.TD],[S.TH,D.TH],[S.THEAD,D.THEAD],[S.TITLE,D.TITLE],[S.TR,D.TR],[S.TRACK,D.TRACK],[S.TT,D.TT],[S.U,D.U],[S.UL,D.UL],[S.SVG,D.SVG],[S.VAR,D.VAR],[S.WBR,D.WBR],[S.XMP,D.XMP]]);function R(e){var t;return(t=O.get(e))!==null&&t!==void 0?t:D.UNKNOWN}const f=D;const L={[d.HTML]:new Set([f.ADDRESS,f.APPLET,f.AREA,f.ARTICLE,f.ASIDE,f.BASE,f.BASEFONT,f.BGSOUND,f.BLOCKQUOTE,f.BODY,f.BR,f.BUTTON,f.CAPTION,f.CENTER,f.COL,f.COLGROUP,f.DD,f.DETAILS,f.DIR,f.DIV,f.DL,f.DT,f.EMBED,f.FIELDSET,f.FIGCAPTION,f.FIGURE,f.FOOTER,f.FORM,f.FRAME,f.FRAMESET,f.H1,f.H2,f.H3,f.H4,f.H5,f.H6,f.HEAD,f.HEADER,f.HGROUP,f.HR,f.HTML,f.IFRAME,f.IMG,f.INPUT,f.LI,f.LINK,f.LISTING,f.MAIN,f.MARQUEE,f.MENU,f.META,f.NAV,f.NOEMBED,f.NOFRAMES,f.NOSCRIPT,f.OBJECT,f.OL,f.P,f.PARAM,f.PLAINTEXT,f.PRE,f.SCRIPT,f.SECTION,f.SELECT,f.SOURCE,f.STYLE,f.SUMMARY,f.TABLE,f.TBODY,f.TD,f.TEMPLATE,f.TEXTAREA,f.TFOOT,f.TH,f.THEAD,f.TITLE,f.TR,f.TRACK,f.UL,f.WBR,f.XMP]),[d.MATHML]:new Set([f.MI,f.MO,f.MN,f.MS,f.MTEXT,f.ANNOTATION_XML]),[d.SVG]:new Set([f.TITLE,f.FOREIGN_OBJECT,f.DESC]),[d.XLINK]:new Set,[d.XML]:new Set,[d.XMLNS]:new Set};const k=new Set([f.H1,f.H2,f.H3,f.H4,f.H5,f.H6]);const M=new Set([S.STYLE,S.SCRIPT,S.XMP,S.IFRAME,S.NOEMBED,S.NOFRAMES,S.PLAINTEXT]);function P(e,t){return M.has(e)||t&&e===S.NOSCRIPT}var g=Object.freeze(Object.defineProperty({__proto__:null,get ATTRS(){return u},get DOCUMENT_MODE(){return C},get NS(){return d},NUMBERED_HEADERS:k,SPECIAL_ELEMENTS:L,get TAG_ID(){return D},get TAG_NAMES(){return S},getTagID:R,hasUnescapedText:P},Symbol.toStringTag,{value:"Module"}));var b;(function(e){e[e.DATA=0]="DATA";e[e.RCDATA=1]="RCDATA";e[e.RAWTEXT=2]="RAWTEXT";e[e.SCRIPT_DATA=3]="SCRIPT_DATA";e[e.PLAINTEXT=4]="PLAINTEXT";e[e.TAG_OPEN=5]="TAG_OPEN";e[e.END_TAG_OPEN=6]="END_TAG_OPEN";e[e.TAG_NAME=7]="TAG_NAME";e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN";e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN";e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME";e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN";e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN";e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME";e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN";e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN";e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME";e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START";e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH";e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED";e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH";e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH";e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN";e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN";e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME";e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START";e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED";e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH";e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH";e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN";e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END";e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME";e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME";e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME";e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE";e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED";e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED";e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED";e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED";e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG";e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT";e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN";e[e.COMMENT_START=42]="COMMENT_START";e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH";e[e.COMMENT=44]="COMMENT";e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN";e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG";e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH";e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH";e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH";e[e.COMMENT_END=50]="COMMENT_END";e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG";e[e.DOCTYPE=52]="DOCTYPE";e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME";e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME";e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME";e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD";e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER";e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED";e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED";e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER";e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS";e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD";e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER";e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED";e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED";e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER";e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE";e[e.CDATA_SECTION=68]="CDATA_SECTION";e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET";e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END";e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE";e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(b||(b={}));const B={DATA:b.DATA,RCDATA:b.RCDATA,RAWTEXT:b.RAWTEXT,SCRIPT_DATA:b.SCRIPT_DATA,PLAINTEXT:b.PLAINTEXT,CDATA_SECTION:b.CDATA_SECTION};function F(e){return e>=o.DIGIT_0&&e<=o.DIGIT_9}function H(e){return e>=o.LATIN_CAPITAL_A&&e<=o.LATIN_CAPITAL_Z}function U(e){return e>=o.LATIN_SMALL_A&&e<=o.LATIN_SMALL_Z}function G(e){return U(e)||H(e)}function y(e){return G(e)||F(e)}function Y(e){return e+32}function w(e){return e===o.SPACE||e===o.LINE_FEED||e===o.TABULATION||e===o.FORM_FEED}function x(e){return w(e)||e===o.SOLIDUS||e===o.GREATER_THAN_SIGN}function v(e){return e===o.NULL?l.nullCharacterReference:e>1114111?l.characterReferenceOutsideUnicodeRange:E(e)?l.surrogateCharacterReference:A(e)?l.noncharacterCharacterReference:h(e)||e===o.CARRIAGE_RETURN?l.controlCharacterReference:null}class Tokenizer{constructor(s,a){this.options=s;this.handler=a;this.paused=false;this.inLoop=false;this.inForeignNode=false;this.lastStartTagName="";this.active=false;this.state=b.DATA;this.returnState=b.DATA;this.entityStartPos=0;this.consumedAfterSnapshot=-1;this.currentCharacterToken=null;this.currentToken=null;this.currentAttr={name:"",value:""};this.preprocessor=new Preprocessor(a);this.currentLocation=this.getCurrentLocation(-1);this.entityDecoder=new e(t,((e,t)=>{this.preprocessor.pos=this.entityStartPos+t-1;this._flushCodePointConsumedAsCharacterReference(e)}),a.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(l.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:e=>{this._err(l.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+e)},validateNumericCharacterReference:e=>{const t=v(e);t&&this._err(t,1)}}:void 0)}_err(e,t=0){var s,a;(a=(s=this.handler).onParseError)===null||a===void 0?void 0:a.call(s,this.preprocessor.getError(e,t))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){this.inLoop=true;while(this.active&&!this.paused){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=false}}pause(){this.paused=true}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=false;if(!this.inLoop){this._runParsingLoop();this.paused||(e===null||e===void 0?void 0:e())}}write(e,t,s){this.active=true;this.preprocessor.write(e,t);this._runParsingLoop();this.paused||(s===null||s===void 0?void 0:s())}insertHtmlAtCurrentPos(e){this.active=true;this.preprocessor.insertHtmlAtCurrentPos(e);this._runParsingLoop()}_ensureHibernation(){if(this.preprocessor.endOfChunkHit){this.preprocessor.retreat(this.consumedAfterSnapshot);this.consumedAfterSnapshot=0;this.active=false;return true}return false}_consume(){this.consumedAfterSnapshot++;return this.preprocessor.advance()}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let t=0;t<e;t++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,t){if(this.preprocessor.startsWith(e,t)){this._advanceBy(e.length-1);return true}return false}_createStartTagToken(){this.currentToken={type:p.START_TAG,tagName:"",tagID:D.UNKNOWN,selfClosing:false,ackSelfClosing:false,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:p.END_TAG,tagName:"",tagID:D.UNKNOWN,selfClosing:false,ackSelfClosing:false,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:p.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:p.DOCTYPE,name:e,forceQuirks:false,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,t){this.currentCharacterToken={type:e,chars:t,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""};this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e;var t;const s=this.currentToken;if(I(s,this.currentAttr.name)===null){s.attrs.push(this.currentAttr);if(s.location&&this.currentLocation){const a=(e=(t=s.location).attrs)!==null&&e!==void 0?e:t.attrs=Object.create(null);a[this.currentAttr.name]=this.currentLocation;this._leaveAttrValue()}}else this._err(l.duplicateAttribute)}_leaveAttrValue(){if(this.currentLocation){this.currentLocation.endLine=this.preprocessor.line;this.currentLocation.endCol=this.preprocessor.col;this.currentLocation.endOffset=this.preprocessor.offset}}prepareToken(e){this._emitCurrentCharacterToken(e.location);this.currentToken=null;if(e.location){e.location.endLine=this.preprocessor.line;e.location.endCol=this.preprocessor.col+1;e.location.endOffset=this.preprocessor.offset+1}this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e);e.tagID=R(e.tagName);if(e.type===p.START_TAG){this.lastStartTagName=e.tagName;this.handler.onStartTag(e)}else{e.attrs.length>0&&this._err(l.endTagWithAttributes);e.selfClosing&&this._err(l.endTagWithTrailingSolidus);this.handler.onEndTag(e)}this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e);this.handler.onComment(e);this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e);this.handler.onDoctype(e);this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){if(e&&this.currentCharacterToken.location){this.currentCharacterToken.location.endLine=e.startLine;this.currentCharacterToken.location.endCol=e.startCol;this.currentCharacterToken.location.endOffset=e.startOffset}switch(this.currentCharacterToken.type){case p.CHARACTER:this.handler.onCharacter(this.currentCharacterToken);break;case p.NULL_CHARACTER:this.handler.onNullCharacter(this.currentCharacterToken);break;case p.WHITESPACE_CHARACTER:this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);if(e){e.endLine=e.startLine;e.endCol=e.startCol;e.endOffset=e.startOffset}this._emitCurrentCharacterToken(e);this.handler.onEof({type:p.EOF,location:e});this.active=false}_appendCharToCurrentCharacterToken(e,t){if(this.currentCharacterToken){if(this.currentCharacterToken.type===e){this.currentCharacterToken.chars+=t;return}this.currentLocation=this.getCurrentLocation(0);this._emitCurrentCharacterToken(this.currentLocation);this.preprocessor.dropParsedChunk()}this._createCharacterToken(e,t)}_emitCodePoint(e){const t=w(e)?p.WHITESPACE_CHARACTER:e===o.NULL?p.NULL_CHARACTER:p.CHARACTER;this._appendCharToCurrentCharacterToken(t,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(p.CHARACTER,e)}_startCharacterReference(){this.returnState=this.state;this.state=b.CHARACTER_REFERENCE;this.entityStartPos=this.preprocessor.pos;this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?s.Attribute:s.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===b.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===b.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===b.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case b.DATA:this._stateData(e);break;case b.RCDATA:this._stateRcdata(e);break;case b.RAWTEXT:this._stateRawtext(e);break;case b.SCRIPT_DATA:this._stateScriptData(e);break;case b.PLAINTEXT:this._statePlaintext(e);break;case b.TAG_OPEN:this._stateTagOpen(e);break;case b.END_TAG_OPEN:this._stateEndTagOpen(e);break;case b.TAG_NAME:this._stateTagName(e);break;case b.RCDATA_LESS_THAN_SIGN:this._stateRcdataLessThanSign(e);break;case b.RCDATA_END_TAG_OPEN:this._stateRcdataEndTagOpen(e);break;case b.RCDATA_END_TAG_NAME:this._stateRcdataEndTagName(e);break;case b.RAWTEXT_LESS_THAN_SIGN:this._stateRawtextLessThanSign(e);break;case b.RAWTEXT_END_TAG_OPEN:this._stateRawtextEndTagOpen(e);break;case b.RAWTEXT_END_TAG_NAME:this._stateRawtextEndTagName(e);break;case b.SCRIPT_DATA_LESS_THAN_SIGN:this._stateScriptDataLessThanSign(e);break;case b.SCRIPT_DATA_END_TAG_OPEN:this._stateScriptDataEndTagOpen(e);break;case b.SCRIPT_DATA_END_TAG_NAME:this._stateScriptDataEndTagName(e);break;case b.SCRIPT_DATA_ESCAPE_START:this._stateScriptDataEscapeStart(e);break;case b.SCRIPT_DATA_ESCAPE_START_DASH:this._stateScriptDataEscapeStartDash(e);break;case b.SCRIPT_DATA_ESCAPED:this._stateScriptDataEscaped(e);break;case b.SCRIPT_DATA_ESCAPED_DASH:this._stateScriptDataEscapedDash(e);break;case b.SCRIPT_DATA_ESCAPED_DASH_DASH:this._stateScriptDataEscapedDashDash(e);break;case b.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:this._stateScriptDataEscapedLessThanSign(e);break;case b.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:this._stateScriptDataEscapedEndTagOpen(e);break;case b.SCRIPT_DATA_ESCAPED_END_TAG_NAME:this._stateScriptDataEscapedEndTagName(e);break;case b.SCRIPT_DATA_DOUBLE_ESCAPE_START:this._stateScriptDataDoubleEscapeStart(e);break;case b.SCRIPT_DATA_DOUBLE_ESCAPED:this._stateScriptDataDoubleEscaped(e);break;case b.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:this._stateScriptDataDoubleEscapedDash(e);break;case b.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:this._stateScriptDataDoubleEscapedDashDash(e);break;case b.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:this._stateScriptDataDoubleEscapedLessThanSign(e);break;case b.SCRIPT_DATA_DOUBLE_ESCAPE_END:this._stateScriptDataDoubleEscapeEnd(e);break;case b.BEFORE_ATTRIBUTE_NAME:this._stateBeforeAttributeName(e);break;case b.ATTRIBUTE_NAME:this._stateAttributeName(e);break;case b.AFTER_ATTRIBUTE_NAME:this._stateAfterAttributeName(e);break;case b.BEFORE_ATTRIBUTE_VALUE:this._stateBeforeAttributeValue(e);break;case b.ATTRIBUTE_VALUE_DOUBLE_QUOTED:this._stateAttributeValueDoubleQuoted(e);break;case b.ATTRIBUTE_VALUE_SINGLE_QUOTED:this._stateAttributeValueSingleQuoted(e);break;case b.ATTRIBUTE_VALUE_UNQUOTED:this._stateAttributeValueUnquoted(e);break;case b.AFTER_ATTRIBUTE_VALUE_QUOTED:this._stateAfterAttributeValueQuoted(e);break;case b.SELF_CLOSING_START_TAG:this._stateSelfClosingStartTag(e);break;case b.BOGUS_COMMENT:this._stateBogusComment(e);break;case b.MARKUP_DECLARATION_OPEN:this._stateMarkupDeclarationOpen(e);break;case b.COMMENT_START:this._stateCommentStart(e);break;case b.COMMENT_START_DASH:this._stateCommentStartDash(e);break;case b.COMMENT:this._stateComment(e);break;case b.COMMENT_LESS_THAN_SIGN:this._stateCommentLessThanSign(e);break;case b.COMMENT_LESS_THAN_SIGN_BANG:this._stateCommentLessThanSignBang(e);break;case b.COMMENT_LESS_THAN_SIGN_BANG_DASH:this._stateCommentLessThanSignBangDash(e);break;case b.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:this._stateCommentLessThanSignBangDashDash(e);break;case b.COMMENT_END_DASH:this._stateCommentEndDash(e);break;case b.COMMENT_END:this._stateCommentEnd(e);break;case b.COMMENT_END_BANG:this._stateCommentEndBang(e);break;case b.DOCTYPE:this._stateDoctype(e);break;case b.BEFORE_DOCTYPE_NAME:this._stateBeforeDoctypeName(e);break;case b.DOCTYPE_NAME:this._stateDoctypeName(e);break;case b.AFTER_DOCTYPE_NAME:this._stateAfterDoctypeName(e);break;case b.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._stateAfterDoctypePublicKeyword(e);break;case b.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:this._stateBeforeDoctypePublicIdentifier(e);break;case b.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:this._stateDoctypePublicIdentifierDoubleQuoted(e);break;case b.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:this._stateDoctypePublicIdentifierSingleQuoted(e);break;case b.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:this._stateAfterDoctypePublicIdentifier(e);break;case b.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break;case b.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._stateAfterDoctypeSystemKeyword(e);break;case b.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:this._stateBeforeDoctypeSystemIdentifier(e);break;case b.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:this._stateDoctypeSystemIdentifierDoubleQuoted(e);break;case b.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:this._stateDoctypeSystemIdentifierSingleQuoted(e);break;case b.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:this._stateAfterDoctypeSystemIdentifier(e);break;case b.BOGUS_DOCTYPE:this._stateBogusDoctype(e);break;case b.CDATA_SECTION:this._stateCdataSection(e);break;case b.CDATA_SECTION_BRACKET:this._stateCdataSectionBracket(e);break;case b.CDATA_SECTION_END:this._stateCdataSectionEnd(e);break;case b.CHARACTER_REFERENCE:this._stateCharacterReference();break;case b.AMBIGUOUS_AMPERSAND:this._stateAmbiguousAmpersand(e);break;default:throw new Error("Unknown state")}}_stateData(e){switch(e){case o.LESS_THAN_SIGN:this.state=b.TAG_OPEN;break;case o.AMPERSAND:this._startCharacterReference();break;case o.NULL:this._err(l.unexpectedNullCharacter);this._emitCodePoint(e);break;case o.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case o.AMPERSAND:this._startCharacterReference();break;case o.LESS_THAN_SIGN:this.state=b.RCDATA_LESS_THAN_SIGN;break;case o.NULL:this._err(l.unexpectedNullCharacter);this._emitChars(i);break;case o.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case o.LESS_THAN_SIGN:this.state=b.RAWTEXT_LESS_THAN_SIGN;break;case o.NULL:this._err(l.unexpectedNullCharacter);this._emitChars(i);break;case o.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case o.LESS_THAN_SIGN:this.state=b.SCRIPT_DATA_LESS_THAN_SIGN;break;case o.NULL:this._err(l.unexpectedNullCharacter);this._emitChars(i);break;case o.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case o.NULL:this._err(l.unexpectedNullCharacter);this._emitChars(i);break;case o.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateTagOpen(e){if(G(e)){this._createStartTagToken();this.state=b.TAG_NAME;this._stateTagName(e)}else switch(e){case o.EXCLAMATION_MARK:this.state=b.MARKUP_DECLARATION_OPEN;break;case o.SOLIDUS:this.state=b.END_TAG_OPEN;break;case o.QUESTION_MARK:this._err(l.unexpectedQuestionMarkInsteadOfTagName);this._createCommentToken(1);this.state=b.BOGUS_COMMENT;this._stateBogusComment(e);break;case o.EOF:this._err(l.eofBeforeTagName);this._emitChars("<");this._emitEOFToken();break;default:this._err(l.invalidFirstCharacterOfTagName);this._emitChars("<");this.state=b.DATA;this._stateData(e)}}_stateEndTagOpen(e){if(G(e)){this._createEndTagToken();this.state=b.TAG_NAME;this._stateTagName(e)}else switch(e){case o.GREATER_THAN_SIGN:this._err(l.missingEndTagName);this.state=b.DATA;break;case o.EOF:this._err(l.eofBeforeTagName);this._emitChars("</");this._emitEOFToken();break;default:this._err(l.invalidFirstCharacterOfTagName);this._createCommentToken(2);this.state=b.BOGUS_COMMENT;this._stateBogusComment(e)}}_stateTagName(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this.state=b.BEFORE_ATTRIBUTE_NAME;break;case o.SOLIDUS:this.state=b.SELF_CLOSING_START_TAG;break;case o.GREATER_THAN_SIGN:this.state=b.DATA;this.emitCurrentTagToken();break;case o.NULL:this._err(l.unexpectedNullCharacter);t.tagName+=i;break;case o.EOF:this._err(l.eofInTag);this._emitEOFToken();break;default:t.tagName+=String.fromCodePoint(H(e)?Y(e):e)}}_stateRcdataLessThanSign(e){if(e===o.SOLIDUS)this.state=b.RCDATA_END_TAG_OPEN;else{this._emitChars("<");this.state=b.RCDATA;this._stateRcdata(e)}}_stateRcdataEndTagOpen(e){if(G(e)){this.state=b.RCDATA_END_TAG_NAME;this._stateRcdataEndTagName(e)}else{this._emitChars("</");this.state=b.RCDATA;this._stateRcdata(e)}}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,false))return!this._ensureHibernation();this._createEndTagToken();const t=this.currentToken;t.tagName=this.lastStartTagName;const s=this.preprocessor.peek(this.lastStartTagName.length);switch(s){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this._advanceBy(this.lastStartTagName.length);this.state=b.BEFORE_ATTRIBUTE_NAME;return false;case o.SOLIDUS:this._advanceBy(this.lastStartTagName.length);this.state=b.SELF_CLOSING_START_TAG;return false;case o.GREATER_THAN_SIGN:this._advanceBy(this.lastStartTagName.length);this.emitCurrentTagToken();this.state=b.DATA;return false;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){if(this.handleSpecialEndTag(e)){this._emitChars("</");this.state=b.RCDATA;this._stateRcdata(e)}}_stateRawtextLessThanSign(e){if(e===o.SOLIDUS)this.state=b.RAWTEXT_END_TAG_OPEN;else{this._emitChars("<");this.state=b.RAWTEXT;this._stateRawtext(e)}}_stateRawtextEndTagOpen(e){if(G(e)){this.state=b.RAWTEXT_END_TAG_NAME;this._stateRawtextEndTagName(e)}else{this._emitChars("</");this.state=b.RAWTEXT;this._stateRawtext(e)}}_stateRawtextEndTagName(e){if(this.handleSpecialEndTag(e)){this._emitChars("</");this.state=b.RAWTEXT;this._stateRawtext(e)}}_stateScriptDataLessThanSign(e){switch(e){case o.SOLIDUS:this.state=b.SCRIPT_DATA_END_TAG_OPEN;break;case o.EXCLAMATION_MARK:this.state=b.SCRIPT_DATA_ESCAPE_START;this._emitChars("<!");break;default:this._emitChars("<");this.state=b.SCRIPT_DATA;this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){if(G(e)){this.state=b.SCRIPT_DATA_END_TAG_NAME;this._stateScriptDataEndTagName(e)}else{this._emitChars("</");this.state=b.SCRIPT_DATA;this._stateScriptData(e)}}_stateScriptDataEndTagName(e){if(this.handleSpecialEndTag(e)){this._emitChars("</");this.state=b.SCRIPT_DATA;this._stateScriptData(e)}}_stateScriptDataEscapeStart(e){if(e===o.HYPHEN_MINUS){this.state=b.SCRIPT_DATA_ESCAPE_START_DASH;this._emitChars("-")}else{this.state=b.SCRIPT_DATA;this._stateScriptData(e)}}_stateScriptDataEscapeStartDash(e){if(e===o.HYPHEN_MINUS){this.state=b.SCRIPT_DATA_ESCAPED_DASH_DASH;this._emitChars("-")}else{this.state=b.SCRIPT_DATA;this._stateScriptData(e)}}_stateScriptDataEscaped(e){switch(e){case o.HYPHEN_MINUS:this.state=b.SCRIPT_DATA_ESCAPED_DASH;this._emitChars("-");break;case o.LESS_THAN_SIGN:this.state=b.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case o.NULL:this._err(l.unexpectedNullCharacter);this._emitChars(i);break;case o.EOF:this._err(l.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case o.HYPHEN_MINUS:this.state=b.SCRIPT_DATA_ESCAPED_DASH_DASH;this._emitChars("-");break;case o.LESS_THAN_SIGN:this.state=b.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case o.NULL:this._err(l.unexpectedNullCharacter);this.state=b.SCRIPT_DATA_ESCAPED;this._emitChars(i);break;case o.EOF:this._err(l.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break;default:this.state=b.SCRIPT_DATA_ESCAPED;this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case o.HYPHEN_MINUS:this._emitChars("-");break;case o.LESS_THAN_SIGN:this.state=b.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case o.GREATER_THAN_SIGN:this.state=b.SCRIPT_DATA;this._emitChars(">");break;case o.NULL:this._err(l.unexpectedNullCharacter);this.state=b.SCRIPT_DATA_ESCAPED;this._emitChars(i);break;case o.EOF:this._err(l.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break;default:this.state=b.SCRIPT_DATA_ESCAPED;this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){if(e===o.SOLIDUS)this.state=b.SCRIPT_DATA_ESCAPED_END_TAG_OPEN;else if(G(e)){this._emitChars("<");this.state=b.SCRIPT_DATA_DOUBLE_ESCAPE_START;this._stateScriptDataDoubleEscapeStart(e)}else{this._emitChars("<");this.state=b.SCRIPT_DATA_ESCAPED;this._stateScriptDataEscaped(e)}}_stateScriptDataEscapedEndTagOpen(e){if(G(e)){this.state=b.SCRIPT_DATA_ESCAPED_END_TAG_NAME;this._stateScriptDataEscapedEndTagName(e)}else{this._emitChars("</");this.state=b.SCRIPT_DATA_ESCAPED;this._stateScriptDataEscaped(e)}}_stateScriptDataEscapedEndTagName(e){if(this.handleSpecialEndTag(e)){this._emitChars("</");this.state=b.SCRIPT_DATA_ESCAPED;this._stateScriptDataEscaped(e)}}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(c.SCRIPT,false)&&x(this.preprocessor.peek(c.SCRIPT.length))){this._emitCodePoint(e);for(let e=0;e<c.SCRIPT.length;e++)this._emitCodePoint(this._consume());this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED}else if(!this._ensureHibernation()){this.state=b.SCRIPT_DATA_ESCAPED;this._stateScriptDataEscaped(e)}}_stateScriptDataDoubleEscaped(e){switch(e){case o.HYPHEN_MINUS:this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED_DASH;this._emitChars("-");break;case o.LESS_THAN_SIGN:this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN;this._emitChars("<");break;case o.NULL:this._err(l.unexpectedNullCharacter);this._emitChars(i);break;case o.EOF:this._err(l.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case o.HYPHEN_MINUS:this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH;this._emitChars("-");break;case o.LESS_THAN_SIGN:this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN;this._emitChars("<");break;case o.NULL:this._err(l.unexpectedNullCharacter);this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED;this._emitChars(i);break;case o.EOF:this._err(l.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break;default:this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED;this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case o.HYPHEN_MINUS:this._emitChars("-");break;case o.LESS_THAN_SIGN:this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN;this._emitChars("<");break;case o.GREATER_THAN_SIGN:this.state=b.SCRIPT_DATA;this._emitChars(">");break;case o.NULL:this._err(l.unexpectedNullCharacter);this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED;this._emitChars(i);break;case o.EOF:this._err(l.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break;default:this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED;this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){if(e===o.SOLIDUS){this.state=b.SCRIPT_DATA_DOUBLE_ESCAPE_END;this._emitChars("/")}else{this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED;this._stateScriptDataDoubleEscaped(e)}}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(c.SCRIPT,false)&&x(this.preprocessor.peek(c.SCRIPT.length))){this._emitCodePoint(e);for(let e=0;e<c.SCRIPT.length;e++)this._emitCodePoint(this._consume());this.state=b.SCRIPT_DATA_ESCAPED}else if(!this._ensureHibernation()){this.state=b.SCRIPT_DATA_DOUBLE_ESCAPED;this._stateScriptDataDoubleEscaped(e)}}_stateBeforeAttributeName(e){switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.SOLIDUS:case o.GREATER_THAN_SIGN:case o.EOF:this.state=b.AFTER_ATTRIBUTE_NAME;this._stateAfterAttributeName(e);break;case o.EQUALS_SIGN:this._err(l.unexpectedEqualsSignBeforeAttributeName);this._createAttr("=");this.state=b.ATTRIBUTE_NAME;break;default:this._createAttr("");this.state=b.ATTRIBUTE_NAME;this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:case o.SOLIDUS:case o.GREATER_THAN_SIGN:case o.EOF:this._leaveAttrName();this.state=b.AFTER_ATTRIBUTE_NAME;this._stateAfterAttributeName(e);break;case o.EQUALS_SIGN:this._leaveAttrName();this.state=b.BEFORE_ATTRIBUTE_VALUE;break;case o.QUOTATION_MARK:case o.APOSTROPHE:case o.LESS_THAN_SIGN:this._err(l.unexpectedCharacterInAttributeName);this.currentAttr.name+=String.fromCodePoint(e);break;case o.NULL:this._err(l.unexpectedNullCharacter);this.currentAttr.name+=i;break;default:this.currentAttr.name+=String.fromCodePoint(H(e)?Y(e):e)}}_stateAfterAttributeName(e){switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.SOLIDUS:this.state=b.SELF_CLOSING_START_TAG;break;case o.EQUALS_SIGN:this.state=b.BEFORE_ATTRIBUTE_VALUE;break;case o.GREATER_THAN_SIGN:this.state=b.DATA;this.emitCurrentTagToken();break;case o.EOF:this._err(l.eofInTag);this._emitEOFToken();break;default:this._createAttr("");this.state=b.ATTRIBUTE_NAME;this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.QUOTATION_MARK:this.state=b.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break;case o.APOSTROPHE:this.state=b.ATTRIBUTE_VALUE_SINGLE_QUOTED;break;case o.GREATER_THAN_SIGN:this._err(l.missingAttributeValue);this.state=b.DATA;this.emitCurrentTagToken();break;default:this.state=b.ATTRIBUTE_VALUE_UNQUOTED;this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case o.QUOTATION_MARK:this.state=b.AFTER_ATTRIBUTE_VALUE_QUOTED;break;case o.AMPERSAND:this._startCharacterReference();break;case o.NULL:this._err(l.unexpectedNullCharacter);this.currentAttr.value+=i;break;case o.EOF:this._err(l.eofInTag);this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case o.APOSTROPHE:this.state=b.AFTER_ATTRIBUTE_VALUE_QUOTED;break;case o.AMPERSAND:this._startCharacterReference();break;case o.NULL:this._err(l.unexpectedNullCharacter);this.currentAttr.value+=i;break;case o.EOF:this._err(l.eofInTag);this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this._leaveAttrValue();this.state=b.BEFORE_ATTRIBUTE_NAME;break;case o.AMPERSAND:this._startCharacterReference();break;case o.GREATER_THAN_SIGN:this._leaveAttrValue();this.state=b.DATA;this.emitCurrentTagToken();break;case o.NULL:this._err(l.unexpectedNullCharacter);this.currentAttr.value+=i;break;case o.QUOTATION_MARK:case o.APOSTROPHE:case o.LESS_THAN_SIGN:case o.EQUALS_SIGN:case o.GRAVE_ACCENT:this._err(l.unexpectedCharacterInUnquotedAttributeValue);this.currentAttr.value+=String.fromCodePoint(e);break;case o.EOF:this._err(l.eofInTag);this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this._leaveAttrValue();this.state=b.BEFORE_ATTRIBUTE_NAME;break;case o.SOLIDUS:this._leaveAttrValue();this.state=b.SELF_CLOSING_START_TAG;break;case o.GREATER_THAN_SIGN:this._leaveAttrValue();this.state=b.DATA;this.emitCurrentTagToken();break;case o.EOF:this._err(l.eofInTag);this._emitEOFToken();break;default:this._err(l.missingWhitespaceBetweenAttributes);this.state=b.BEFORE_ATTRIBUTE_NAME;this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case o.GREATER_THAN_SIGN:{const e=this.currentToken;e.selfClosing=true;this.state=b.DATA;this.emitCurrentTagToken();break}case o.EOF:this._err(l.eofInTag);this._emitEOFToken();break;default:this._err(l.unexpectedSolidusInTag);this.state=b.BEFORE_ATTRIBUTE_NAME;this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const t=this.currentToken;switch(e){case o.GREATER_THAN_SIGN:this.state=b.DATA;this.emitCurrentComment(t);break;case o.EOF:this.emitCurrentComment(t);this._emitEOFToken();break;case o.NULL:this._err(l.unexpectedNullCharacter);t.data+=i;break;default:t.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){if(this._consumeSequenceIfMatch(c.DASH_DASH,true)){this._createCommentToken(c.DASH_DASH.length+1);this.state=b.COMMENT_START}else if(this._consumeSequenceIfMatch(c.DOCTYPE,false)){this.currentLocation=this.getCurrentLocation(c.DOCTYPE.length+1);this.state=b.DOCTYPE}else if(this._consumeSequenceIfMatch(c.CDATA_START,true))if(this.inForeignNode)this.state=b.CDATA_SECTION;else{this._err(l.cdataInHtmlContent);this._createCommentToken(c.CDATA_START.length+1);this.currentToken.data="[CDATA[";this.state=b.BOGUS_COMMENT}else if(!this._ensureHibernation()){this._err(l.incorrectlyOpenedComment);this._createCommentToken(2);this.state=b.BOGUS_COMMENT;this._stateBogusComment(e)}}_stateCommentStart(e){switch(e){case o.HYPHEN_MINUS:this.state=b.COMMENT_START_DASH;break;case o.GREATER_THAN_SIGN:{this._err(l.abruptClosingOfEmptyComment);this.state=b.DATA;const e=this.currentToken;this.emitCurrentComment(e);break}default:this.state=b.COMMENT;this._stateComment(e)}}_stateCommentStartDash(e){const t=this.currentToken;switch(e){case o.HYPHEN_MINUS:this.state=b.COMMENT_END;break;case o.GREATER_THAN_SIGN:this._err(l.abruptClosingOfEmptyComment);this.state=b.DATA;this.emitCurrentComment(t);break;case o.EOF:this._err(l.eofInComment);this.emitCurrentComment(t);this._emitEOFToken();break;default:t.data+="-";this.state=b.COMMENT;this._stateComment(e)}}_stateComment(e){const t=this.currentToken;switch(e){case o.HYPHEN_MINUS:this.state=b.COMMENT_END_DASH;break;case o.LESS_THAN_SIGN:t.data+="<";this.state=b.COMMENT_LESS_THAN_SIGN;break;case o.NULL:this._err(l.unexpectedNullCharacter);t.data+=i;break;case o.EOF:this._err(l.eofInComment);this.emitCurrentComment(t);this._emitEOFToken();break;default:t.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const t=this.currentToken;switch(e){case o.EXCLAMATION_MARK:t.data+="!";this.state=b.COMMENT_LESS_THAN_SIGN_BANG;break;case o.LESS_THAN_SIGN:t.data+="<";break;default:this.state=b.COMMENT;this._stateComment(e)}}_stateCommentLessThanSignBang(e){if(e===o.HYPHEN_MINUS)this.state=b.COMMENT_LESS_THAN_SIGN_BANG_DASH;else{this.state=b.COMMENT;this._stateComment(e)}}_stateCommentLessThanSignBangDash(e){if(e===o.HYPHEN_MINUS)this.state=b.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH;else{this.state=b.COMMENT_END_DASH;this._stateCommentEndDash(e)}}_stateCommentLessThanSignBangDashDash(e){e!==o.GREATER_THAN_SIGN&&e!==o.EOF&&this._err(l.nestedComment);this.state=b.COMMENT_END;this._stateCommentEnd(e)}_stateCommentEndDash(e){const t=this.currentToken;switch(e){case o.HYPHEN_MINUS:this.state=b.COMMENT_END;break;case o.EOF:this._err(l.eofInComment);this.emitCurrentComment(t);this._emitEOFToken();break;default:t.data+="-";this.state=b.COMMENT;this._stateComment(e)}}_stateCommentEnd(e){const t=this.currentToken;switch(e){case o.GREATER_THAN_SIGN:this.state=b.DATA;this.emitCurrentComment(t);break;case o.EXCLAMATION_MARK:this.state=b.COMMENT_END_BANG;break;case o.HYPHEN_MINUS:t.data+="-";break;case o.EOF:this._err(l.eofInComment);this.emitCurrentComment(t);this._emitEOFToken();break;default:t.data+="--";this.state=b.COMMENT;this._stateComment(e)}}_stateCommentEndBang(e){const t=this.currentToken;switch(e){case o.HYPHEN_MINUS:t.data+="--!";this.state=b.COMMENT_END_DASH;break;case o.GREATER_THAN_SIGN:this._err(l.incorrectlyClosedComment);this.state=b.DATA;this.emitCurrentComment(t);break;case o.EOF:this._err(l.eofInComment);this.emitCurrentComment(t);this._emitEOFToken();break;default:t.data+="--!";this.state=b.COMMENT;this._stateComment(e)}}_stateDoctype(e){switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this.state=b.BEFORE_DOCTYPE_NAME;break;case o.GREATER_THAN_SIGN:this.state=b.BEFORE_DOCTYPE_NAME;this._stateBeforeDoctypeName(e);break;case o.EOF:{this._err(l.eofInDoctype);this._createDoctypeToken(null);const e=this.currentToken;e.forceQuirks=true;this.emitCurrentDoctype(e);this._emitEOFToken();break}default:this._err(l.missingWhitespaceBeforeDoctypeName);this.state=b.BEFORE_DOCTYPE_NAME;this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(H(e)){this._createDoctypeToken(String.fromCharCode(Y(e)));this.state=b.DOCTYPE_NAME}else switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.NULL:this._err(l.unexpectedNullCharacter);this._createDoctypeToken(i);this.state=b.DOCTYPE_NAME;break;case o.GREATER_THAN_SIGN:{this._err(l.missingDoctypeName);this._createDoctypeToken(null);const e=this.currentToken;e.forceQuirks=true;this.emitCurrentDoctype(e);this.state=b.DATA;break}case o.EOF:{this._err(l.eofInDoctype);this._createDoctypeToken(null);const e=this.currentToken;e.forceQuirks=true;this.emitCurrentDoctype(e);this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e));this.state=b.DOCTYPE_NAME}}_stateDoctypeName(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this.state=b.AFTER_DOCTYPE_NAME;break;case o.GREATER_THAN_SIGN:this.state=b.DATA;this.emitCurrentDoctype(t);break;case o.NULL:this._err(l.unexpectedNullCharacter);t.name+=i;break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:t.name+=String.fromCodePoint(H(e)?Y(e):e)}}_stateAfterDoctypeName(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.GREATER_THAN_SIGN:this.state=b.DATA;this.emitCurrentDoctype(t);break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:if(this._consumeSequenceIfMatch(c.PUBLIC,false))this.state=b.AFTER_DOCTYPE_PUBLIC_KEYWORD;else if(this._consumeSequenceIfMatch(c.SYSTEM,false))this.state=b.AFTER_DOCTYPE_SYSTEM_KEYWORD;else if(!this._ensureHibernation()){this._err(l.invalidCharacterSequenceAfterDoctypeName);t.forceQuirks=true;this.state=b.BOGUS_DOCTYPE;this._stateBogusDoctype(e)}}}_stateAfterDoctypePublicKeyword(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this.state=b.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break;case o.QUOTATION_MARK:this._err(l.missingWhitespaceAfterDoctypePublicKeyword);t.publicId="";this.state=b.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break;case o.APOSTROPHE:this._err(l.missingWhitespaceAfterDoctypePublicKeyword);t.publicId="";this.state=b.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break;case o.GREATER_THAN_SIGN:this._err(l.missingDoctypePublicIdentifier);t.forceQuirks=true;this.state=b.DATA;this.emitCurrentDoctype(t);break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:this._err(l.missingQuoteBeforeDoctypePublicIdentifier);t.forceQuirks=true;this.state=b.BOGUS_DOCTYPE;this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.QUOTATION_MARK:t.publicId="";this.state=b.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break;case o.APOSTROPHE:t.publicId="";this.state=b.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break;case o.GREATER_THAN_SIGN:this._err(l.missingDoctypePublicIdentifier);t.forceQuirks=true;this.state=b.DATA;this.emitCurrentDoctype(t);break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:this._err(l.missingQuoteBeforeDoctypePublicIdentifier);t.forceQuirks=true;this.state=b.BOGUS_DOCTYPE;this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const t=this.currentToken;switch(e){case o.QUOTATION_MARK:this.state=b.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break;case o.NULL:this._err(l.unexpectedNullCharacter);t.publicId+=i;break;case o.GREATER_THAN_SIGN:this._err(l.abruptDoctypePublicIdentifier);t.forceQuirks=true;this.emitCurrentDoctype(t);this.state=b.DATA;break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:t.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const t=this.currentToken;switch(e){case o.APOSTROPHE:this.state=b.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break;case o.NULL:this._err(l.unexpectedNullCharacter);t.publicId+=i;break;case o.GREATER_THAN_SIGN:this._err(l.abruptDoctypePublicIdentifier);t.forceQuirks=true;this.emitCurrentDoctype(t);this.state=b.DATA;break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:t.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this.state=b.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break;case o.GREATER_THAN_SIGN:this.state=b.DATA;this.emitCurrentDoctype(t);break;case o.QUOTATION_MARK:this._err(l.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers);t.systemId="";this.state=b.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case o.APOSTROPHE:this._err(l.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers);t.systemId="";this.state=b.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:this._err(l.missingQuoteBeforeDoctypeSystemIdentifier);t.forceQuirks=true;this.state=b.BOGUS_DOCTYPE;this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.GREATER_THAN_SIGN:this.emitCurrentDoctype(t);this.state=b.DATA;break;case o.QUOTATION_MARK:t.systemId="";this.state=b.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case o.APOSTROPHE:t.systemId="";this.state=b.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:this._err(l.missingQuoteBeforeDoctypeSystemIdentifier);t.forceQuirks=true;this.state=b.BOGUS_DOCTYPE;this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:this.state=b.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break;case o.QUOTATION_MARK:this._err(l.missingWhitespaceAfterDoctypeSystemKeyword);t.systemId="";this.state=b.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case o.APOSTROPHE:this._err(l.missingWhitespaceAfterDoctypeSystemKeyword);t.systemId="";this.state=b.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case o.GREATER_THAN_SIGN:this._err(l.missingDoctypeSystemIdentifier);t.forceQuirks=true;this.state=b.DATA;this.emitCurrentDoctype(t);break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:this._err(l.missingQuoteBeforeDoctypeSystemIdentifier);t.forceQuirks=true;this.state=b.BOGUS_DOCTYPE;this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.QUOTATION_MARK:t.systemId="";this.state=b.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case o.APOSTROPHE:t.systemId="";this.state=b.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case o.GREATER_THAN_SIGN:this._err(l.missingDoctypeSystemIdentifier);t.forceQuirks=true;this.state=b.DATA;this.emitCurrentDoctype(t);break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:this._err(l.missingQuoteBeforeDoctypeSystemIdentifier);t.forceQuirks=true;this.state=b.BOGUS_DOCTYPE;this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const t=this.currentToken;switch(e){case o.QUOTATION_MARK:this.state=b.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break;case o.NULL:this._err(l.unexpectedNullCharacter);t.systemId+=i;break;case o.GREATER_THAN_SIGN:this._err(l.abruptDoctypeSystemIdentifier);t.forceQuirks=true;this.emitCurrentDoctype(t);this.state=b.DATA;break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:t.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const t=this.currentToken;switch(e){case o.APOSTROPHE:this.state=b.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break;case o.NULL:this._err(l.unexpectedNullCharacter);t.systemId+=i;break;case o.GREATER_THAN_SIGN:this._err(l.abruptDoctypeSystemIdentifier);t.forceQuirks=true;this.emitCurrentDoctype(t);this.state=b.DATA;break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:t.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const t=this.currentToken;switch(e){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.GREATER_THAN_SIGN:this.emitCurrentDoctype(t);this.state=b.DATA;break;case o.EOF:this._err(l.eofInDoctype);t.forceQuirks=true;this.emitCurrentDoctype(t);this._emitEOFToken();break;default:this._err(l.unexpectedCharacterAfterDoctypeSystemIdentifier);this.state=b.BOGUS_DOCTYPE;this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const t=this.currentToken;switch(e){case o.GREATER_THAN_SIGN:this.emitCurrentDoctype(t);this.state=b.DATA;break;case o.NULL:this._err(l.unexpectedNullCharacter);break;case o.EOF:this.emitCurrentDoctype(t);this._emitEOFToken();break;default:}}_stateCdataSection(e){switch(e){case o.RIGHT_SQUARE_BRACKET:this.state=b.CDATA_SECTION_BRACKET;break;case o.EOF:this._err(l.eofInCdata);this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){if(e===o.RIGHT_SQUARE_BRACKET)this.state=b.CDATA_SECTION_END;else{this._emitChars("]");this.state=b.CDATA_SECTION;this._stateCdataSection(e)}}_stateCdataSectionEnd(e){switch(e){case o.GREATER_THAN_SIGN:this.state=b.DATA;break;case o.RIGHT_SQUARE_BRACKET:this._emitChars("]");break;default:this._emitChars("]]");this.state=b.CDATA_SECTION;this._stateCdataSection(e)}}_stateCharacterReference(){let e=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(e<0){if(!this.preprocessor.lastChunkWritten){this.active=false;this.preprocessor.pos=this.preprocessor.html.length-1;this.consumedAfterSnapshot=0;this.preprocessor.endOfChunkHit=true;return}e=this.entityDecoder.end()}if(e===0){this.preprocessor.pos=this.entityStartPos;this._flushCodePointConsumedAsCharacterReference(o.AMPERSAND);this.state=!this._isCharacterReferenceInAttribute()&&y(this.preprocessor.peek(1))?b.AMBIGUOUS_AMPERSAND:this.returnState}else this.state=this.returnState}_stateAmbiguousAmpersand(e){if(y(e))this._flushCodePointConsumedAsCharacterReference(e);else{e===o.SEMICOLON&&this._err(l.unknownNamedCharacterReference);this.state=this.returnState;this._callState(e)}}}const Q=new Set([D.DD,D.DT,D.LI,D.OPTGROUP,D.OPTION,D.P,D.RB,D.RP,D.RT,D.RTC]);const W=new Set([...Q,D.CAPTION,D.COLGROUP,D.TBODY,D.TD,D.TFOOT,D.TH,D.THEAD,D.TR]);const K=new Set([D.APPLET,D.CAPTION,D.HTML,D.MARQUEE,D.OBJECT,D.TABLE,D.TD,D.TEMPLATE,D.TH]);const X=new Set([...K,D.OL,D.UL]);const V=new Set([...K,D.BUTTON]);const q=new Set([D.ANNOTATION_XML,D.MI,D.MN,D.MO,D.MS,D.MTEXT]);const z=new Set([D.DESC,D.FOREIGN_OBJECT,D.TITLE]);const j=new Set([D.TR,D.TEMPLATE,D.HTML]);const J=new Set([D.TBODY,D.TFOOT,D.THEAD,D.TEMPLATE,D.HTML]);const $=new Set([D.TABLE,D.TEMPLATE,D.HTML]);const Z=new Set([D.TD,D.TH]);class OpenElementStack{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,t,s){this.treeAdapter=t;this.handler=s;this.items=[];this.tagIDs=[];this.stackTop=-1;this.tmplCount=0;this.currentTagId=D.UNKNOWN;this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===D.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===d.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop];this.currentTagId=this.tagIDs[this.stackTop]}push(e,t){this.stackTop++;this.items[this.stackTop]=e;this.current=e;this.tagIDs[this.stackTop]=t;this.currentTagId=t;this._isInTemplate()&&this.tmplCount++;this.handler.onItemPush(e,t,true)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--;this.stackTop--;this._updateCurrentElement();this.handler.onItemPop(e,true)}replace(e,t){const s=this._indexOf(e);this.items[s]=t;s===this.stackTop&&(this.current=t)}insertAfter(e,t,s){const a=this._indexOf(e)+1;this.items.splice(a,0,t);this.tagIDs.splice(a,0,s);this.stackTop++;a===this.stackTop&&this._updateCurrentElement();this.current&&this.currentTagId!==void 0&&this.handler.onItemPush(this.current,this.currentTagId,a===this.stackTop)}popUntilTagNamePopped(e){let t=this.stackTop+1;do{t=this.tagIDs.lastIndexOf(e,t-1)}while(t>0&&this.treeAdapter.getNamespaceURI(this.items[t])!==d.HTML);this.shortenToLength(Math.max(t,0))}shortenToLength(e){while(this.stackTop>=e){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1);this.stackTop--;this._updateCurrentElement();this.handler.onItemPop(t,this.stackTop<e)}}popUntilElementPopped(e){const t=this._indexOf(e);this.shortenToLength(Math.max(t,0))}popUntilPopped(e,t){const s=this._indexOfTagNames(e,t);this.shortenToLength(Math.max(s,0))}popUntilNumberedHeaderPopped(){this.popUntilPopped(k,d.HTML)}popUntilTableCellPopped(){this.popUntilPopped(Z,d.HTML)}popAllUpToHtmlElement(){this.tmplCount=0;this.shortenToLength(1)}_indexOfTagNames(e,t){for(let s=this.stackTop;s>=0;s--)if(e.has(this.tagIDs[s])&&this.treeAdapter.getNamespaceURI(this.items[s])===t)return s;return-1}clearBackTo(e,t){const s=this._indexOfTagNames(e,t);this.shortenToLength(s+1)}clearBackToTableContext(){this.clearBackTo($,d.HTML)}clearBackToTableBodyContext(){this.clearBackTo(J,d.HTML)}clearBackToTableRowContext(){this.clearBackTo(j,d.HTML)}remove(e){const t=this._indexOf(e);if(t>=0)if(t===this.stackTop)this.pop();else{this.items.splice(t,1);this.tagIDs.splice(t,1);this.stackTop--;this._updateCurrentElement();this.handler.onItemPop(e,false)}}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===D.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const t=this._indexOf(e)-1;return t>=0?this.items[t]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===D.HTML}hasInDynamicScope(e,t){for(let s=this.stackTop;s>=0;s--){const a=this.tagIDs[s];switch(this.treeAdapter.getNamespaceURI(this.items[s])){case d.HTML:if(a===e)return true;if(t.has(a))return false;break;case d.SVG:if(z.has(a))return false;break;case d.MATHML:if(q.has(a))return false;break}}return true}hasInScope(e){return this.hasInDynamicScope(e,K)}hasInListItemScope(e){return this.hasInDynamicScope(e,X)}hasInButtonScope(e){return this.hasInDynamicScope(e,V)}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const t=this.tagIDs[e];switch(this.treeAdapter.getNamespaceURI(this.items[e])){case d.HTML:if(k.has(t))return true;if(K.has(t))return false;break;case d.SVG:if(z.has(t))return false;break;case d.MATHML:if(q.has(t))return false;break}}return true}hasInTableScope(e){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===d.HTML)switch(this.tagIDs[t]){case e:return true;case D.TABLE:case D.HTML:return false}return true}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--)if(this.treeAdapter.getNamespaceURI(this.items[e])===d.HTML)switch(this.tagIDs[e]){case D.TBODY:case D.THEAD:case D.TFOOT:return true;case D.TABLE:case D.HTML:return false}return true}hasInSelectScope(e){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===d.HTML)switch(this.tagIDs[t]){case e:return true;case D.OPTION:case D.OPTGROUP:break;default:return false}return true}generateImpliedEndTags(){while(this.currentTagId!==void 0&&Q.has(this.currentTagId))this.pop()}generateImpliedEndTagsThoroughly(){while(this.currentTagId!==void 0&&W.has(this.currentTagId))this.pop()}generateImpliedEndTagsWithExclusion(e){while(this.currentTagId!==void 0&&this.currentTagId!==e&&W.has(this.currentTagId))this.pop()}}const ee=3;var te;(function(e){e[e.Marker=0]="Marker";e[e.Element=1]="Element"})(te||(te={}));const se={type:te.Marker};class FormattingElementList{constructor(e){this.treeAdapter=e;this.entries=[];this.bookmark=null}_getNoahArkConditionCandidates(e,t){const s=[];const a=t.length;const n=this.treeAdapter.getTagName(e);const r=this.treeAdapter.getNamespaceURI(e);for(let e=0;e<this.entries.length;e++){const t=this.entries[e];if(t.type===te.Marker)break;const{element:i}=t;if(this.treeAdapter.getTagName(i)===n&&this.treeAdapter.getNamespaceURI(i)===r){const t=this.treeAdapter.getAttrList(i);t.length===a&&s.push({idx:e,attrs:t})}}return s}_ensureNoahArkCondition(e){if(this.entries.length<ee)return;const t=this.treeAdapter.getAttrList(e);const s=this._getNoahArkConditionCandidates(e,t);if(s.length<ee)return;const a=new Map(t.map((e=>[e.name,e.value])));let n=0;for(let e=0;e<s.length;e++){const t=s[e];if(t.attrs.every((e=>a.get(e.name)===e.value))){n+=1;n>=ee&&this.entries.splice(t.idx,1)}}}insertMarker(){this.entries.unshift(se)}pushElement(e,t){this._ensureNoahArkCondition(e);this.entries.unshift({type:te.Element,element:e,token:t})}insertElementAfterBookmark(e,t){const s=this.entries.indexOf(this.bookmark);this.entries.splice(s,0,{type:te.Element,element:e,token:t})}removeEntry(e){const t=this.entries.indexOf(e);t!==-1&&this.entries.splice(t,1)}clearToLastMarker(){const e=this.entries.indexOf(se);e===-1?this.entries.length=0:this.entries.splice(0,e+1)}getElementEntryInScopeWithTagName(e){const t=this.entries.find((t=>t.type===te.Marker||this.treeAdapter.getTagName(t.element)===e));return t&&t.type===te.Element?t:null}getElementEntry(e){return this.entries.find((t=>t.type===te.Element&&t.element===e))}}const ae={createDocument(){return{nodeName:"#document",mode:C.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,s){return{nodeName:e,tagName:e,attrs:s,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t);t.parentNode=e},insertBefore(e,t,s){const a=e.childNodes.indexOf(s);e.childNodes.splice(a,0,t);t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,s,a){const n=e.childNodes.find((e=>e.nodeName==="#documentType"));if(n){n.name=t;n.publicId=s;n.systemId=a}else{const n={nodeName:"#documentType",name:t,publicId:s,systemId:a,parentNode:null};ae.appendChild(e,n)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1);e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const s=e.childNodes[e.childNodes.length-1];if(ae.isTextNode(s)){s.value+=t;return}}ae.appendChild(e,ae.createTextNode(t))},insertTextBefore(e,t,s){const a=e.childNodes[e.childNodes.indexOf(s)-1];a&&ae.isTextNode(a)?a.value+=t:ae.insertBefore(e,ae.createTextNode(t),s)},adoptAttributes(e,t){const s=new Set(e.attrs.map((e=>e.name)));for(let a=0;a<t.length;a++)s.has(t[a].name)||e.attrs.push(t[a])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};const ne="html";const re="about:legacy-compat";const ie="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd";const oe=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"];const ce=[...oe,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];const Ee=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]);const Te=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"];const _e=[...Te,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function he(e,t){return t.some((t=>e.startsWith(t)))}function Ae(e){return e.name===ne&&e.publicId===null&&(e.systemId===null||e.systemId===re)}function le(e){if(e.name!==ne)return C.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===ie)return C.QUIRKS;let{publicId:s}=e;if(s!==null){s=s.toLowerCase();if(Ee.has(s))return C.QUIRKS;let e=t===null?ce:oe;if(he(s,e))return C.QUIRKS;e=t===null?Te:_e;if(he(s,e))return C.LIMITED_QUIRKS}return C.NO_QUIRKS}const me={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"};const pe="definitionurl";const Ie="definitionURL";const Ne=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map((e=>[e.toLowerCase(),e])));const de=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:d.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:d.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:d.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:d.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:d.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:d.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:d.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:d.XML}],["xml:space",{prefix:"xml",name:"space",namespace:d.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:d.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:d.XMLNS}]]);const ue=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map((e=>[e.toLowerCase(),e])));const Ce=new Set([D.B,D.BIG,D.BLOCKQUOTE,D.BODY,D.BR,D.CENTER,D.CODE,D.DD,D.DIV,D.DL,D.DT,D.EM,D.EMBED,D.H1,D.H2,D.H3,D.H4,D.H5,D.H6,D.HEAD,D.HR,D.I,D.IMG,D.LI,D.LISTING,D.MENU,D.META,D.NOBR,D.OL,D.P,D.PRE,D.RUBY,D.S,D.SMALL,D.SPAN,D.STRONG,D.STRIKE,D.SUB,D.SUP,D.TABLE,D.TT,D.U,D.UL,D.VAR]);function Se(e){const t=e.tagID;const s=t===D.FONT&&e.attrs.some((({name:e})=>e===u.COLOR||e===u.SIZE||e===u.FACE));return s||Ce.has(t)}function De(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===pe){e.attrs[t].name=Ie;break}}function Oe(e){for(let t=0;t<e.attrs.length;t++){const s=Ne.get(e.attrs[t].name);s!=null&&(e.attrs[t].name=s)}}function Re(e){for(let t=0;t<e.attrs.length;t++){const s=de.get(e.attrs[t].name);if(s){e.attrs[t].prefix=s.prefix;e.attrs[t].name=s.name;e.attrs[t].namespace=s.namespace}}}function fe(e){const t=ue.get(e.tagName);if(t!=null){e.tagName=t;e.tagID=R(e.tagName)}}function Le(e,t){return t===d.MATHML&&(e===D.MI||e===D.MO||e===D.MN||e===D.MS||e===D.MTEXT)}function ke(e,t,s){if(t===d.MATHML&&e===D.ANNOTATION_XML)for(let e=0;e<s.length;e++)if(s[e].name===u.ENCODING){const t=s[e].value.toLowerCase();return t===me.TEXT_HTML||t===me.APPLICATION_XML}return t===d.SVG&&(e===D.FOREIGN_OBJECT||e===D.DESC||e===D.TITLE)}function Me(e,t,s,a){return(!a||a===d.HTML)&&ke(e,t,s)||(!a||a===d.MATHML)&&Le(e,t)}var Pe=Object.freeze(Object.defineProperty({__proto__:null,SVG_TAG_NAMES_ADJUSTMENT_MAP:ue,adjustTokenMathMLAttrs:De,adjustTokenSVGAttrs:Oe,adjustTokenSVGTagName:fe,adjustTokenXMLAttrs:Re,causesExit:Se,isIntegrationPoint:Me},Symbol.toStringTag,{value:"Module"}));const ge="hidden";const be=8;const Be=3;var Fe;(function(e){e[e.INITIAL=0]="INITIAL";e[e.BEFORE_HTML=1]="BEFORE_HTML";e[e.BEFORE_HEAD=2]="BEFORE_HEAD";e[e.IN_HEAD=3]="IN_HEAD";e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT";e[e.AFTER_HEAD=5]="AFTER_HEAD";e[e.IN_BODY=6]="IN_BODY";e[e.TEXT=7]="TEXT";e[e.IN_TABLE=8]="IN_TABLE";e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT";e[e.IN_CAPTION=10]="IN_CAPTION";e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP";e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY";e[e.IN_ROW=13]="IN_ROW";e[e.IN_CELL=14]="IN_CELL";e[e.IN_SELECT=15]="IN_SELECT";e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE";e[e.IN_TEMPLATE=17]="IN_TEMPLATE";e[e.AFTER_BODY=18]="AFTER_BODY";e[e.IN_FRAMESET=19]="IN_FRAMESET";e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET";e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY";e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(Fe||(Fe={}));const He={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1};const Ue=new Set([D.TABLE,D.TBODY,D.TFOOT,D.THEAD,D.TR]);const Ge={scriptingEnabled:true,sourceCodeLocationInfo:false,treeAdapter:ae,onParseError:null};class Parser{constructor(e,t,s=null,a=null){this.fragmentContext=s;this.scriptHandler=a;this.currentToken=null;this.stopped=false;this.insertionMode=Fe.INITIAL;this.originalInsertionMode=Fe.INITIAL;this.headElement=null;this.formElement=null;this.currentNotInHTML=false;this.tmplInsertionModeStack=[];this.pendingCharacterTokens=[];this.hasNonWhitespacePendingCharacterToken=false;this.framesetOk=true;this.skipNextNewLine=false;this.fosterParentingEnabled=false;this.options={...Ge,...e};this.treeAdapter=this.options.treeAdapter;this.onParseError=this.options.onParseError;this.onParseError&&(this.options.sourceCodeLocationInfo=true);this.document=t!==null&&t!==void 0?t:this.treeAdapter.createDocument();this.tokenizer=new Tokenizer(this.options,this);this.activeFormattingElements=new FormattingElementList(this.treeAdapter);this.fragmentContextID=s?R(this.treeAdapter.getTagName(s)):D.UNKNOWN;this._setContextModes(s!==null&&s!==void 0?s:this.document,this.fragmentContextID);this.openElements=new OpenElementStack(this.document,this.treeAdapter,this)}static parse(e,t){const s=new this(t);s.tokenizer.write(e,true);return s.document}static getFragmentParser(e,t){const s={...Ge,...t};e!==null&&e!==void 0?e:e=s.treeAdapter.createElement(S.TEMPLATE,d.HTML,[]);const a=s.treeAdapter.createElement("documentmock",d.HTML,[]);const n=new this(s,a,e);n.fragmentContextID===D.TEMPLATE&&n.tmplInsertionModeStack.unshift(Fe.IN_TEMPLATE);n._initTokenizerForFragmentParsing();n._insertFakeRootElement();n._resetInsertionMode();n._findFormInFragmentContext();return n}getFragment(){const e=this.treeAdapter.getFirstChild(this.document);const t=this.treeAdapter.createDocumentFragment();this._adoptNodes(e,t);return t}_err(e,t,s){var a;if(!this.onParseError)return;const n=(a=e.location)!==null&&a!==void 0?a:He;const r={code:t,startLine:n.startLine,startCol:n.startCol,startOffset:n.startOffset,endLine:s?n.startLine:n.endLine,endCol:s?n.startCol:n.endCol,endOffset:s?n.startOffset:n.endOffset};this.onParseError(r)}onItemPush(e,t,s){var a,n;(n=(a=this.treeAdapter).onItemPush)===null||n===void 0?void 0:n.call(a,e);s&&this.openElements.stackTop>0&&this._setContextModes(e,t)}onItemPop(e,t){var s,a;this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken);(a=(s=this.treeAdapter).onItemPop)===null||a===void 0?void 0:a.call(s,e,this.openElements.current);if(t){let e;let t;if(this.openElements.stackTop===0&&this.fragmentContext){e=this.fragmentContext;t=this.fragmentContextID}else({current:e,currentTagId:t}=this.openElements);this._setContextModes(e,t)}}_setContextModes(e,t){const s=e===this.document||e&&this.treeAdapter.getNamespaceURI(e)===d.HTML;this.currentNotInHTML=!s;this.tokenizer.inForeignNode=!s&&e!==void 0&&t!==void 0&&!this._isIntegrationPoint(t,e)}_switchToTextParsing(e,t){this._insertElement(e,d.HTML);this.tokenizer.state=t;this.originalInsertionMode=this.insertionMode;this.insertionMode=Fe.TEXT}switchToPlaintextParsing(){this.insertionMode=Fe.TEXT;this.originalInsertionMode=Fe.IN_BODY;this.tokenizer.state=B.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;while(e){if(this.treeAdapter.getTagName(e)===S.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(this.fragmentContext&&this.treeAdapter.getNamespaceURI(this.fragmentContext)===d.HTML)switch(this.fragmentContextID){case D.TITLE:case D.TEXTAREA:this.tokenizer.state=B.RCDATA;break;case D.STYLE:case D.XMP:case D.IFRAME:case D.NOEMBED:case D.NOFRAMES:case D.NOSCRIPT:this.tokenizer.state=B.RAWTEXT;break;case D.SCRIPT:this.tokenizer.state=B.SCRIPT_DATA;break;case D.PLAINTEXT:this.tokenizer.state=B.PLAINTEXT;break;default:}}_setDocumentType(e){const t=e.name||"";const s=e.publicId||"";const a=e.systemId||"";this.treeAdapter.setDocumentType(this.document,t,s,a);if(e.location){const t=this.treeAdapter.getChildNodes(this.document);const s=t.find((e=>this.treeAdapter.isDocumentTypeNode(e)));s&&this.treeAdapter.setNodeSourceCodeLocation(s,e.location)}}_attachElementToTree(e,t){if(this.options.sourceCodeLocationInfo){const s=t&&{...t,startTag:t};this.treeAdapter.setNodeSourceCodeLocation(e,s)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const t=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(t!==null&&t!==void 0?t:this.document,e)}}_appendElement(e,t){const s=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(s,e.location)}_insertElement(e,t){const s=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(s,e.location);this.openElements.push(s,e.tagID)}_insertFakeElement(e,t){const s=this.treeAdapter.createElement(e,d.HTML,[]);this._attachElementToTree(s,null);this.openElements.push(s,t)}_insertTemplate(e){const t=this.treeAdapter.createElement(e.tagName,d.HTML,e.attrs);const s=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(t,s);this._attachElementToTree(t,e.location);this.openElements.push(t,e.tagID);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(s,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(S.HTML,d.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null);this.treeAdapter.appendChild(this.openElements.current,e);this.openElements.push(e,D.HTML)}_appendCommentNode(e,t){const s=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(t,s);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(s,e.location)}_insertCharacters(e){let t;let s;if(this._shouldFosterParentOnInsertion()){({parent:t,beforeElement:s}=this._findFosterParentingLocation());s?this.treeAdapter.insertTextBefore(t,e.chars,s):this.treeAdapter.insertText(t,e.chars)}else{t=this.openElements.currentTmplContentOrNode;this.treeAdapter.insertText(t,e.chars)}if(!e.location)return;const a=this.treeAdapter.getChildNodes(t);const n=s?a.lastIndexOf(s):a.length;const r=a[n-1];const i=this.treeAdapter.getNodeSourceCodeLocation(r);if(i){const{endLine:t,endCol:s,endOffset:a}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(r,{endLine:t,endCol:s,endOffset:a})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(r,e.location)}_adoptNodes(e,t){for(let s=this.treeAdapter.getFirstChild(e);s;s=this.treeAdapter.getFirstChild(e)){this.treeAdapter.detachNode(s);this.treeAdapter.appendChild(t,s)}}_setEndLocation(e,t){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&t.location){const s=t.location;const a=this.treeAdapter.getTagName(e);const n=t.type===p.END_TAG&&a===t.tagName?{endTag:{...s},endLine:s.endLine,endCol:s.endCol,endOffset:s.endOffset}:{endLine:s.startLine,endCol:s.startCol,endOffset:s.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,n)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return false;let t;let s;if(this.openElements.stackTop===0&&this.fragmentContext){t=this.fragmentContext;s=this.fragmentContextID}else({current:t,currentTagId:s}=this.openElements);return(e.tagID!==D.SVG||this.treeAdapter.getTagName(t)!==S.ANNOTATION_XML||this.treeAdapter.getNamespaceURI(t)!==d.MATHML)&&(this.tokenizer.inForeignNode||(e.tagID===D.MGLYPH||e.tagID===D.MALIGNMARK)&&s!==void 0&&!this._isIntegrationPoint(s,t,d.HTML))}_processToken(e){switch(e.type){case p.CHARACTER:this.onCharacter(e);break;case p.NULL_CHARACTER:this.onNullCharacter(e);break;case p.COMMENT:this.onComment(e);break;case p.DOCTYPE:this.onDoctype(e);break;case p.START_TAG:this._processStartTag(e);break;case p.END_TAG:this.onEndTag(e);break;case p.EOF:this.onEof(e);break;case p.WHITESPACE_CHARACTER:this.onWhitespaceCharacter(e);break}}_isIntegrationPoint(e,t,s){const a=this.treeAdapter.getNamespaceURI(t);const n=this.treeAdapter.getAttrList(t);return Me(e,a,n,s)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const t=this.activeFormattingElements.entries.findIndex((e=>e.type===te.Marker||this.openElements.contains(e.element)));const s=t===-1?e-1:t-1;for(let e=s;e>=0;e--){const t=this.activeFormattingElements.entries[e];this._insertElement(t.token,this.treeAdapter.getNamespaceURI(t.element));t.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags();this.openElements.popUntilTableCellPopped();this.activeFormattingElements.clearToLastMarker();this.insertionMode=Fe.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(D.P);this.openElements.popUntilTagNamePopped(D.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case D.TR:this.insertionMode=Fe.IN_ROW;return;case D.TBODY:case D.THEAD:case D.TFOOT:this.insertionMode=Fe.IN_TABLE_BODY;return;case D.CAPTION:this.insertionMode=Fe.IN_CAPTION;return;case D.COLGROUP:this.insertionMode=Fe.IN_COLUMN_GROUP;return;case D.TABLE:this.insertionMode=Fe.IN_TABLE;return;case D.BODY:this.insertionMode=Fe.IN_BODY;return;case D.FRAMESET:this.insertionMode=Fe.IN_FRAMESET;return;case D.SELECT:this._resetInsertionModeForSelect(e);return;case D.TEMPLATE:this.insertionMode=this.tmplInsertionModeStack[0];return;case D.HTML:this.insertionMode=this.headElement?Fe.AFTER_HEAD:Fe.BEFORE_HEAD;return;case D.TD:case D.TH:if(e>0){this.insertionMode=Fe.IN_CELL;return}break;case D.HEAD:if(e>0){this.insertionMode=Fe.IN_HEAD;return}break}this.insertionMode=Fe.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let t=e-1;t>0;t--){const e=this.openElements.tagIDs[t];if(e===D.TEMPLATE)break;if(e===D.TABLE){this.insertionMode=Fe.IN_SELECT_IN_TABLE;return}}this.insertionMode=Fe.IN_SELECT}_isElementCausesFosterParenting(e){return Ue.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this.openElements.currentTagId!==void 0&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const t=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case D.TEMPLATE:if(this.treeAdapter.getNamespaceURI(t)===d.HTML)return{parent:this.treeAdapter.getTemplateContent(t),beforeElement:null};break;case D.TABLE:{const s=this.treeAdapter.getParentNode(t);return s?{parent:s,beforeElement:t}:{parent:this.openElements.items[e-1],beforeElement:null}}default:}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const t=this._findFosterParentingLocation();t.beforeElement?this.treeAdapter.insertBefore(t.parent,e,t.beforeElement):this.treeAdapter.appendChild(t.parent,e)}_isSpecialElement(e,t){const s=this.treeAdapter.getNamespaceURI(e);return L[s].has(t)}onCharacter(e){this.skipNextNewLine=false;if(this.tokenizer.inForeignNode)ta(this,e);else switch(this.insertionMode){case Fe.INITIAL:je(this,e);break;case Fe.BEFORE_HTML:Ze(this,e);break;case Fe.BEFORE_HEAD:st(this,e);break;case Fe.IN_HEAD:it(this,e);break;case Fe.IN_HEAD_NO_SCRIPT:Et(this,e);break;case Fe.AFTER_HEAD:ht(this,e);break;case Fe.IN_BODY:case Fe.IN_CAPTION:case Fe.IN_CELL:case Fe.IN_TEMPLATE:mt(this,e);break;case Fe.TEXT:case Fe.IN_SELECT:case Fe.IN_SELECT_IN_TABLE:this._insertCharacters(e);break;case Fe.IN_TABLE:case Fe.IN_TABLE_BODY:case Fe.IN_ROW:Ts(this,e);break;case Fe.IN_TABLE_TEXT:Ds(this,e);break;case Fe.IN_COLUMN_GROUP:Ps(this,e);break;case Fe.AFTER_BODY:Xs(this,e);break;case Fe.AFTER_AFTER_BODY:$s(this,e);break;default:}}onNullCharacter(e){this.skipNextNewLine=false;if(this.tokenizer.inForeignNode)ea(this,e);else switch(this.insertionMode){case Fe.INITIAL:je(this,e);break;case Fe.BEFORE_HTML:Ze(this,e);break;case Fe.BEFORE_HEAD:st(this,e);break;case Fe.IN_HEAD:it(this,e);break;case Fe.IN_HEAD_NO_SCRIPT:Et(this,e);break;case Fe.AFTER_HEAD:ht(this,e);break;case Fe.TEXT:this._insertCharacters(e);break;case Fe.IN_TABLE:case Fe.IN_TABLE_BODY:case Fe.IN_ROW:Ts(this,e);break;case Fe.IN_COLUMN_GROUP:Ps(this,e);break;case Fe.AFTER_BODY:Xs(this,e);break;case Fe.AFTER_AFTER_BODY:$s(this,e);break;default:}}onComment(e){this.skipNextNewLine=false;if(this.currentNotInHTML)Ke(this,e);else switch(this.insertionMode){case Fe.INITIAL:case Fe.BEFORE_HTML:case Fe.BEFORE_HEAD:case Fe.IN_HEAD:case Fe.IN_HEAD_NO_SCRIPT:case Fe.AFTER_HEAD:case Fe.IN_BODY:case Fe.IN_TABLE:case Fe.IN_CAPTION:case Fe.IN_COLUMN_GROUP:case Fe.IN_TABLE_BODY:case Fe.IN_ROW:case Fe.IN_CELL:case Fe.IN_SELECT:case Fe.IN_SELECT_IN_TABLE:case Fe.IN_TEMPLATE:case Fe.IN_FRAMESET:case Fe.AFTER_FRAMESET:Ke(this,e);break;case Fe.IN_TABLE_TEXT:Os(this,e);break;case Fe.AFTER_BODY:Xe(this,e);break;case Fe.AFTER_AFTER_BODY:case Fe.AFTER_AFTER_FRAMESET:Ve(this,e);break;default:}}onDoctype(e){this.skipNextNewLine=false;switch(this.insertionMode){case Fe.INITIAL:ze(this,e);break;case Fe.BEFORE_HEAD:case Fe.IN_HEAD:case Fe.IN_HEAD_NO_SCRIPT:case Fe.AFTER_HEAD:this._err(e,l.misplacedDoctype);break;case Fe.IN_TABLE_TEXT:Os(this,e);break;default:}}onStartTag(e){this.skipNextNewLine=false;this.currentToken=e;this._processStartTag(e);e.selfClosing&&!e.ackSelfClosing&&this._err(e,l.nonVoidHtmlElementStartTagWithTrailingSolidus)}
/**
     * Processes a given start tag.
     *
     * `onStartTag` checks if a self-closing tag was recognized. When a token
     * is moved inbetween multiple insertion modes, this check for self-closing
     * could lead to false positives. To avoid this, `_processStartTag` is used
     * for nested calls.
     *
     * @param token The token to process.
     * @protected
     */_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?aa(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case Fe.INITIAL:je(this,e);break;case Fe.BEFORE_HTML:Je(this,e);break;case Fe.BEFORE_HEAD:et(this,e);break;case Fe.IN_HEAD:at(this,e);break;case Fe.IN_HEAD_NO_SCRIPT:ot(this,e);break;case Fe.AFTER_HEAD:Tt(this,e);break;case Fe.IN_BODY:qt(this,e);break;case Fe.IN_TABLE:ds(this,e);break;case Fe.IN_TABLE_TEXT:Os(this,e);break;case Fe.IN_CAPTION:fs(this,e);break;case Fe.IN_COLUMN_GROUP:ks(this,e);break;case Fe.IN_TABLE_BODY:gs(this,e);break;case Fe.IN_ROW:Bs(this,e);break;case Fe.IN_CELL:Hs(this,e);break;case Fe.IN_SELECT:Gs(this,e);break;case Fe.IN_SELECT_IN_TABLE:Ys(this,e);break;case Fe.IN_TEMPLATE:xs(this,e);break;case Fe.AFTER_BODY:Ws(this,e);break;case Fe.IN_FRAMESET:Vs(this,e);break;case Fe.AFTER_FRAMESET:zs(this,e);break;case Fe.AFTER_AFTER_BODY:Js(this,e);break;case Fe.AFTER_AFTER_FRAMESET:Zs(this,e);break;default:}}onEndTag(e){this.skipNextNewLine=false;this.currentToken=e;this.currentNotInHTML?na(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case Fe.INITIAL:je(this,e);break;case Fe.BEFORE_HTML:$e(this,e);break;case Fe.BEFORE_HEAD:tt(this,e);break;case Fe.IN_HEAD:nt(this,e);break;case Fe.IN_HEAD_NO_SCRIPT:ct(this,e);break;case Fe.AFTER_HEAD:_t(this,e);break;case Fe.IN_BODY:is(this,e);break;case Fe.TEXT:cs(this,e);break;case Fe.IN_TABLE:us(this,e);break;case Fe.IN_TABLE_TEXT:Os(this,e);break;case Fe.IN_CAPTION:Ls(this,e);break;case Fe.IN_COLUMN_GROUP:Ms(this,e);break;case Fe.IN_TABLE_BODY:bs(this,e);break;case Fe.IN_ROW:Fs(this,e);break;case Fe.IN_CELL:Us(this,e);break;case Fe.IN_SELECT:ys(this,e);break;case Fe.IN_SELECT_IN_TABLE:ws(this,e);break;case Fe.IN_TEMPLATE:vs(this,e);break;case Fe.AFTER_BODY:Ks(this,e);break;case Fe.IN_FRAMESET:qs(this,e);break;case Fe.AFTER_FRAMESET:js(this,e);break;case Fe.AFTER_AFTER_BODY:$s(this,e);break;default:}}onEof(e){switch(this.insertionMode){case Fe.INITIAL:je(this,e);break;case Fe.BEFORE_HTML:Ze(this,e);break;case Fe.BEFORE_HEAD:st(this,e);break;case Fe.IN_HEAD:it(this,e);break;case Fe.IN_HEAD_NO_SCRIPT:Et(this,e);break;case Fe.AFTER_HEAD:ht(this,e);break;case Fe.IN_BODY:case Fe.IN_TABLE:case Fe.IN_CAPTION:case Fe.IN_COLUMN_GROUP:case Fe.IN_TABLE_BODY:case Fe.IN_ROW:case Fe.IN_CELL:case Fe.IN_SELECT:case Fe.IN_SELECT_IN_TABLE:os(this,e);break;case Fe.TEXT:Es(this,e);break;case Fe.IN_TABLE_TEXT:Os(this,e);break;case Fe.IN_TEMPLATE:Qs(this,e);break;case Fe.AFTER_BODY:case Fe.IN_FRAMESET:case Fe.AFTER_FRAMESET:case Fe.AFTER_AFTER_BODY:case Fe.AFTER_AFTER_FRAMESET:qe(this,e);break;default:}}onWhitespaceCharacter(e){if(this.skipNextNewLine){this.skipNextNewLine=false;if(e.chars.charCodeAt(0)===o.LINE_FEED){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}}if(this.tokenizer.inForeignNode)this._insertCharacters(e);else switch(this.insertionMode){case Fe.IN_HEAD:case Fe.IN_HEAD_NO_SCRIPT:case Fe.AFTER_HEAD:case Fe.TEXT:case Fe.IN_COLUMN_GROUP:case Fe.IN_SELECT:case Fe.IN_SELECT_IN_TABLE:case Fe.IN_FRAMESET:case Fe.AFTER_FRAMESET:this._insertCharacters(e);break;case Fe.IN_BODY:case Fe.IN_CAPTION:case Fe.IN_CELL:case Fe.IN_TEMPLATE:case Fe.AFTER_BODY:case Fe.AFTER_AFTER_BODY:case Fe.AFTER_AFTER_FRAMESET:lt(this,e);break;case Fe.IN_TABLE:case Fe.IN_TABLE_BODY:case Fe.IN_ROW:Ts(this,e);break;case Fe.IN_TABLE_TEXT:Ss(this,e);break;default:}}}function ye(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);if(s)if(e.openElements.contains(s.element))e.openElements.hasInScope(t.tagID)||(s=null);else{e.activeFormattingElements.removeEntry(s);s=null}else rs(e,t);return s}function Ye(e,t){let s=null;let a=e.openElements.stackTop;for(;a>=0;a--){const n=e.openElements.items[a];if(n===t.element)break;e._isSpecialElement(n,e.openElements.tagIDs[a])&&(s=n)}if(!s){e.openElements.shortenToLength(Math.max(a,0));e.activeFormattingElements.removeEntry(t)}return s}function we(e,t,s){let a=t;let n=e.openElements.getCommonAncestor(t);for(let r=0,i=n;i!==s;r++,i=n){n=e.openElements.getCommonAncestor(i);const s=e.activeFormattingElements.getElementEntry(i);const o=s&&r>=Be;const c=!s||o;if(c){o&&e.activeFormattingElements.removeEntry(s);e.openElements.remove(i)}else{i=xe(e,s);a===t&&(e.activeFormattingElements.bookmark=s);e.treeAdapter.detachNode(a);e.treeAdapter.appendChild(i,a);a=i}}return a}function xe(e,t){const s=e.treeAdapter.getNamespaceURI(t.element);const a=e.treeAdapter.createElement(t.token.tagName,s,t.token.attrs);e.openElements.replace(t.element,a);t.element=a;return a}function ve(e,t,s){const a=e.treeAdapter.getTagName(t);const n=R(a);if(e._isElementCausesFosterParenting(n))e._fosterParentElement(s);else{const a=e.treeAdapter.getNamespaceURI(t);n===D.TEMPLATE&&a===d.HTML&&(t=e.treeAdapter.getTemplateContent(t));e.treeAdapter.appendChild(t,s)}}function Qe(e,t,s){const a=e.treeAdapter.getNamespaceURI(s.element);const{token:n}=s;const r=e.treeAdapter.createElement(n.tagName,a,n.attrs);e._adoptNodes(t,r);e.treeAdapter.appendChild(t,r);e.activeFormattingElements.insertElementAfterBookmark(r,n);e.activeFormattingElements.removeEntry(s);e.openElements.remove(s.element);e.openElements.insertAfter(t,r,n.tagID)}function We(e,t){for(let s=0;s<be;s++){const s=ye(e,t);if(!s)break;const a=Ye(e,s);if(!a)break;e.activeFormattingElements.bookmark=s;const n=we(e,a,s.element);const r=e.openElements.getCommonAncestor(s.element);e.treeAdapter.detachNode(n);r&&ve(e,r,n);Qe(e,a,s)}}function Ke(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function Xe(e,t){e._appendCommentNode(t,e.openElements.items[0])}function Ve(e,t){e._appendCommentNode(t,e.document)}function qe(e,t){e.stopped=true;if(t.location){const s=e.fragmentContext?0:2;for(let a=e.openElements.stackTop;a>=s;a--)e._setEndLocation(e.openElements.items[a],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const s=e.openElements.items[0];const a=e.treeAdapter.getNodeSourceCodeLocation(s);if(a&&!a.endTag){e._setEndLocation(s,t);if(e.openElements.stackTop>=1){const s=e.openElements.items[1];const a=e.treeAdapter.getNodeSourceCodeLocation(s);a&&!a.endTag&&e._setEndLocation(s,t)}}}}}function ze(e,t){e._setDocumentType(t);const s=t.forceQuirks?C.QUIRKS:le(t);Ae(t)||e._err(t,l.nonConformingDoctype);e.treeAdapter.setDocumentMode(e.document,s);e.insertionMode=Fe.BEFORE_HTML}function je(e,t){e._err(t,l.missingDoctype,true);e.treeAdapter.setDocumentMode(e.document,C.QUIRKS);e.insertionMode=Fe.BEFORE_HTML;e._processToken(t)}function Je(e,t){if(t.tagID===D.HTML){e._insertElement(t,d.HTML);e.insertionMode=Fe.BEFORE_HEAD}else Ze(e,t)}function $e(e,t){const s=t.tagID;s!==D.HTML&&s!==D.HEAD&&s!==D.BODY&&s!==D.BR||Ze(e,t)}function Ze(e,t){e._insertFakeRootElement();e.insertionMode=Fe.BEFORE_HEAD;e._processToken(t)}function et(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.HEAD:e._insertElement(t,d.HTML);e.headElement=e.openElements.current;e.insertionMode=Fe.IN_HEAD;break;default:st(e,t)}}function tt(e,t){const s=t.tagID;s===D.HEAD||s===D.BODY||s===D.HTML||s===D.BR?st(e,t):e._err(t,l.endTagWithoutMatchingOpenElement)}function st(e,t){e._insertFakeElement(S.HEAD,D.HEAD);e.headElement=e.openElements.current;e.insertionMode=Fe.IN_HEAD;e._processToken(t)}function at(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.BASE:case D.BASEFONT:case D.BGSOUND:case D.LINK:case D.META:e._appendElement(t,d.HTML);t.ackSelfClosing=true;break;case D.TITLE:e._switchToTextParsing(t,B.RCDATA);break;case D.NOSCRIPT:if(e.options.scriptingEnabled)e._switchToTextParsing(t,B.RAWTEXT);else{e._insertElement(t,d.HTML);e.insertionMode=Fe.IN_HEAD_NO_SCRIPT}break;case D.NOFRAMES:case D.STYLE:e._switchToTextParsing(t,B.RAWTEXT);break;case D.SCRIPT:e._switchToTextParsing(t,B.SCRIPT_DATA);break;case D.TEMPLATE:e._insertTemplate(t);e.activeFormattingElements.insertMarker();e.framesetOk=false;e.insertionMode=Fe.IN_TEMPLATE;e.tmplInsertionModeStack.unshift(Fe.IN_TEMPLATE);break;case D.HEAD:e._err(t,l.misplacedStartTagForHeadElement);break;default:it(e,t)}}function nt(e,t){switch(t.tagID){case D.HEAD:e.openElements.pop();e.insertionMode=Fe.AFTER_HEAD;break;case D.BODY:case D.BR:case D.HTML:it(e,t);break;case D.TEMPLATE:rt(e,t);break;default:e._err(t,l.endTagWithoutMatchingOpenElement)}}function rt(e,t){if(e.openElements.tmplCount>0){e.openElements.generateImpliedEndTagsThoroughly();e.openElements.currentTagId!==D.TEMPLATE&&e._err(t,l.closingOfElementWithOpenChildElements);e.openElements.popUntilTagNamePopped(D.TEMPLATE);e.activeFormattingElements.clearToLastMarker();e.tmplInsertionModeStack.shift();e._resetInsertionMode()}else e._err(t,l.endTagWithoutMatchingOpenElement)}function it(e,t){e.openElements.pop();e.insertionMode=Fe.AFTER_HEAD;e._processToken(t)}function ot(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.BASEFONT:case D.BGSOUND:case D.HEAD:case D.LINK:case D.META:case D.NOFRAMES:case D.STYLE:at(e,t);break;case D.NOSCRIPT:e._err(t,l.nestedNoscriptInHead);break;default:Et(e,t)}}function ct(e,t){switch(t.tagID){case D.NOSCRIPT:e.openElements.pop();e.insertionMode=Fe.IN_HEAD;break;case D.BR:Et(e,t);break;default:e._err(t,l.endTagWithoutMatchingOpenElement)}}function Et(e,t){const s=t.type===p.EOF?l.openElementsLeftAfterEof:l.disallowedContentInNoscriptInHead;e._err(t,s);e.openElements.pop();e.insertionMode=Fe.IN_HEAD;e._processToken(t)}function Tt(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.BODY:e._insertElement(t,d.HTML);e.framesetOk=false;e.insertionMode=Fe.IN_BODY;break;case D.FRAMESET:e._insertElement(t,d.HTML);e.insertionMode=Fe.IN_FRAMESET;break;case D.BASE:case D.BASEFONT:case D.BGSOUND:case D.LINK:case D.META:case D.NOFRAMES:case D.SCRIPT:case D.STYLE:case D.TEMPLATE:case D.TITLE:e._err(t,l.abandonedHeadElementChild);e.openElements.push(e.headElement,D.HEAD);at(e,t);e.openElements.remove(e.headElement);break;case D.HEAD:e._err(t,l.misplacedStartTagForHeadElement);break;default:ht(e,t)}}function _t(e,t){switch(t.tagID){case D.BODY:case D.HTML:case D.BR:ht(e,t);break;case D.TEMPLATE:rt(e,t);break;default:e._err(t,l.endTagWithoutMatchingOpenElement)}}function ht(e,t){e._insertFakeElement(S.BODY,D.BODY);e.insertionMode=Fe.IN_BODY;At(e,t)}function At(e,t){switch(t.type){case p.CHARACTER:mt(e,t);break;case p.WHITESPACE_CHARACTER:lt(e,t);break;case p.COMMENT:Ke(e,t);break;case p.START_TAG:qt(e,t);break;case p.END_TAG:is(e,t);break;case p.EOF:os(e,t);break;default:}}function lt(e,t){e._reconstructActiveFormattingElements();e._insertCharacters(t)}function mt(e,t){e._reconstructActiveFormattingElements();e._insertCharacters(t);e.framesetOk=false}function pt(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function It(e,t){const s=e.openElements.tryPeekProperlyNestedBodyElement();if(s&&e.openElements.tmplCount===0){e.framesetOk=false;e.treeAdapter.adoptAttributes(s,t.attrs)}}function Nt(e,t){const s=e.openElements.tryPeekProperlyNestedBodyElement();if(e.framesetOk&&s){e.treeAdapter.detachNode(s);e.openElements.popAllUpToHtmlElement();e._insertElement(t,d.HTML);e.insertionMode=Fe.IN_FRAMESET}}function dt(e,t){e.openElements.hasInButtonScope(D.P)&&e._closePElement();e._insertElement(t,d.HTML)}function ut(e,t){e.openElements.hasInButtonScope(D.P)&&e._closePElement();e.openElements.currentTagId!==void 0&&k.has(e.openElements.currentTagId)&&e.openElements.pop();e._insertElement(t,d.HTML)}function Ct(e,t){e.openElements.hasInButtonScope(D.P)&&e._closePElement();e._insertElement(t,d.HTML);e.skipNextNewLine=true;e.framesetOk=false}function St(e,t){const s=e.openElements.tmplCount>0;if(!e.formElement||s){e.openElements.hasInButtonScope(D.P)&&e._closePElement();e._insertElement(t,d.HTML);s||(e.formElement=e.openElements.current)}}function Dt(e,t){e.framesetOk=false;const s=t.tagID;for(let t=e.openElements.stackTop;t>=0;t--){const a=e.openElements.tagIDs[t];if(s===D.LI&&a===D.LI||(s===D.DD||s===D.DT)&&(a===D.DD||a===D.DT)){e.openElements.generateImpliedEndTagsWithExclusion(a);e.openElements.popUntilTagNamePopped(a);break}if(a!==D.ADDRESS&&a!==D.DIV&&a!==D.P&&e._isSpecialElement(e.openElements.items[t],a))break}e.openElements.hasInButtonScope(D.P)&&e._closePElement();e._insertElement(t,d.HTML)}function Ot(e,t){e.openElements.hasInButtonScope(D.P)&&e._closePElement();e._insertElement(t,d.HTML);e.tokenizer.state=B.PLAINTEXT}function Rt(e,t){if(e.openElements.hasInScope(D.BUTTON)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(D.BUTTON)}e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.framesetOk=false}function ft(e,t){const s=e.activeFormattingElements.getElementEntryInScopeWithTagName(S.A);if(s){We(e,t);e.openElements.remove(s.element);e.activeFormattingElements.removeEntry(s)}e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.activeFormattingElements.pushElement(e.openElements.current,t)}function Lt(e,t){e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.activeFormattingElements.pushElement(e.openElements.current,t)}function kt(e,t){e._reconstructActiveFormattingElements();if(e.openElements.hasInScope(D.NOBR)){We(e,t);e._reconstructActiveFormattingElements()}e._insertElement(t,d.HTML);e.activeFormattingElements.pushElement(e.openElements.current,t)}function Mt(e,t){e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.activeFormattingElements.insertMarker();e.framesetOk=false}function Pt(e,t){e.treeAdapter.getDocumentMode(e.document)!==C.QUIRKS&&e.openElements.hasInButtonScope(D.P)&&e._closePElement();e._insertElement(t,d.HTML);e.framesetOk=false;e.insertionMode=Fe.IN_TABLE}function gt(e,t){e._reconstructActiveFormattingElements();e._appendElement(t,d.HTML);e.framesetOk=false;t.ackSelfClosing=true}function bt(e){const t=I(e,u.TYPE);return t!=null&&t.toLowerCase()===ge}function Bt(e,t){e._reconstructActiveFormattingElements();e._appendElement(t,d.HTML);bt(t)||(e.framesetOk=false);t.ackSelfClosing=true}function Ft(e,t){e._appendElement(t,d.HTML);t.ackSelfClosing=true}function Ht(e,t){e.openElements.hasInButtonScope(D.P)&&e._closePElement();e._appendElement(t,d.HTML);e.framesetOk=false;t.ackSelfClosing=true}function Ut(e,t){t.tagName=S.IMG;t.tagID=D.IMG;gt(e,t)}function Gt(e,t){e._insertElement(t,d.HTML);e.skipNextNewLine=true;e.tokenizer.state=B.RCDATA;e.originalInsertionMode=e.insertionMode;e.framesetOk=false;e.insertionMode=Fe.TEXT}function yt(e,t){e.openElements.hasInButtonScope(D.P)&&e._closePElement();e._reconstructActiveFormattingElements();e.framesetOk=false;e._switchToTextParsing(t,B.RAWTEXT)}function Yt(e,t){e.framesetOk=false;e._switchToTextParsing(t,B.RAWTEXT)}function wt(e,t){e._switchToTextParsing(t,B.RAWTEXT)}function xt(e,t){e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML);e.framesetOk=false;e.insertionMode=e.insertionMode===Fe.IN_TABLE||e.insertionMode===Fe.IN_CAPTION||e.insertionMode===Fe.IN_TABLE_BODY||e.insertionMode===Fe.IN_ROW||e.insertionMode===Fe.IN_CELL?Fe.IN_SELECT_IN_TABLE:Fe.IN_SELECT}function vt(e,t){e.openElements.currentTagId===D.OPTION&&e.openElements.pop();e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML)}function Qt(e,t){e.openElements.hasInScope(D.RUBY)&&e.openElements.generateImpliedEndTags();e._insertElement(t,d.HTML)}function Wt(e,t){e.openElements.hasInScope(D.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(D.RTC);e._insertElement(t,d.HTML)}function Kt(e,t){e._reconstructActiveFormattingElements();De(t);Re(t);t.selfClosing?e._appendElement(t,d.MATHML):e._insertElement(t,d.MATHML);t.ackSelfClosing=true}function Xt(e,t){e._reconstructActiveFormattingElements();Oe(t);Re(t);t.selfClosing?e._appendElement(t,d.SVG):e._insertElement(t,d.SVG);t.ackSelfClosing=true}function Vt(e,t){e._reconstructActiveFormattingElements();e._insertElement(t,d.HTML)}function qt(e,t){switch(t.tagID){case D.I:case D.S:case D.B:case D.U:case D.EM:case D.TT:case D.BIG:case D.CODE:case D.FONT:case D.SMALL:case D.STRIKE:case D.STRONG:Lt(e,t);break;case D.A:ft(e,t);break;case D.H1:case D.H2:case D.H3:case D.H4:case D.H5:case D.H6:ut(e,t);break;case D.P:case D.DL:case D.OL:case D.UL:case D.DIV:case D.DIR:case D.NAV:case D.MAIN:case D.MENU:case D.ASIDE:case D.CENTER:case D.FIGURE:case D.FOOTER:case D.HEADER:case D.HGROUP:case D.DIALOG:case D.DETAILS:case D.ADDRESS:case D.ARTICLE:case D.SEARCH:case D.SECTION:case D.SUMMARY:case D.FIELDSET:case D.BLOCKQUOTE:case D.FIGCAPTION:dt(e,t);break;case D.LI:case D.DD:case D.DT:Dt(e,t);break;case D.BR:case D.IMG:case D.WBR:case D.AREA:case D.EMBED:case D.KEYGEN:gt(e,t);break;case D.HR:Ht(e,t);break;case D.RB:case D.RTC:Qt(e,t);break;case D.RT:case D.RP:Wt(e,t);break;case D.PRE:case D.LISTING:Ct(e,t);break;case D.XMP:yt(e,t);break;case D.SVG:Xt(e,t);break;case D.HTML:pt(e,t);break;case D.BASE:case D.LINK:case D.META:case D.STYLE:case D.TITLE:case D.SCRIPT:case D.BGSOUND:case D.BASEFONT:case D.TEMPLATE:at(e,t);break;case D.BODY:It(e,t);break;case D.FORM:St(e,t);break;case D.NOBR:kt(e,t);break;case D.MATH:Kt(e,t);break;case D.TABLE:Pt(e,t);break;case D.INPUT:Bt(e,t);break;case D.PARAM:case D.TRACK:case D.SOURCE:Ft(e,t);break;case D.IMAGE:Ut(e,t);break;case D.BUTTON:Rt(e,t);break;case D.APPLET:case D.OBJECT:case D.MARQUEE:Mt(e,t);break;case D.IFRAME:Yt(e,t);break;case D.SELECT:xt(e,t);break;case D.OPTION:case D.OPTGROUP:vt(e,t);break;case D.NOEMBED:case D.NOFRAMES:wt(e,t);break;case D.FRAMESET:Nt(e,t);break;case D.TEXTAREA:Gt(e,t);break;case D.NOSCRIPT:e.options.scriptingEnabled?wt(e,t):Vt(e,t);break;case D.PLAINTEXT:Ot(e,t);break;case D.COL:case D.TH:case D.TD:case D.TR:case D.HEAD:case D.FRAME:case D.TBODY:case D.TFOOT:case D.THEAD:case D.CAPTION:case D.COLGROUP:break;default:Vt(e,t)}}function zt(e,t){if(e.openElements.hasInScope(D.BODY)){e.insertionMode=Fe.AFTER_BODY;if(e.options.sourceCodeLocationInfo){const s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e._setEndLocation(s,t)}}}function jt(e,t){if(e.openElements.hasInScope(D.BODY)){e.insertionMode=Fe.AFTER_BODY;Ks(e,t)}}function Jt(e,t){const s=t.tagID;if(e.openElements.hasInScope(s)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(s)}}function $t(e){const t=e.openElements.tmplCount>0;const{formElement:s}=e;t||(e.formElement=null);if((s||t)&&e.openElements.hasInScope(D.FORM)){e.openElements.generateImpliedEndTags();t?e.openElements.popUntilTagNamePopped(D.FORM):s&&e.openElements.remove(s)}}function Zt(e){e.openElements.hasInButtonScope(D.P)||e._insertFakeElement(S.P,D.P);e._closePElement()}function es(e){if(e.openElements.hasInListItemScope(D.LI)){e.openElements.generateImpliedEndTagsWithExclusion(D.LI);e.openElements.popUntilTagNamePopped(D.LI)}}function ts(e,t){const s=t.tagID;if(e.openElements.hasInScope(s)){e.openElements.generateImpliedEndTagsWithExclusion(s);e.openElements.popUntilTagNamePopped(s)}}function ss(e){if(e.openElements.hasNumberedHeaderInScope()){e.openElements.generateImpliedEndTags();e.openElements.popUntilNumberedHeaderPopped()}}function as(e,t){const s=t.tagID;if(e.openElements.hasInScope(s)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(s);e.activeFormattingElements.clearToLastMarker()}}function ns(e){e._reconstructActiveFormattingElements();e._insertFakeElement(S.BR,D.BR);e.openElements.pop();e.framesetOk=false}function rs(e,t){const s=t.tagName;const a=t.tagID;for(let t=e.openElements.stackTop;t>0;t--){const n=e.openElements.items[t];const r=e.openElements.tagIDs[t];if(a===r&&(a!==D.UNKNOWN||e.treeAdapter.getTagName(n)===s)){e.openElements.generateImpliedEndTagsWithExclusion(a);e.openElements.stackTop>=t&&e.openElements.shortenToLength(t);break}if(e._isSpecialElement(n,r))break}}function is(e,t){switch(t.tagID){case D.A:case D.B:case D.I:case D.S:case D.U:case D.EM:case D.TT:case D.BIG:case D.CODE:case D.FONT:case D.NOBR:case D.SMALL:case D.STRIKE:case D.STRONG:We(e,t);break;case D.P:Zt(e);break;case D.DL:case D.UL:case D.OL:case D.DIR:case D.DIV:case D.NAV:case D.PRE:case D.MAIN:case D.MENU:case D.ASIDE:case D.BUTTON:case D.CENTER:case D.FIGURE:case D.FOOTER:case D.HEADER:case D.HGROUP:case D.DIALOG:case D.ADDRESS:case D.ARTICLE:case D.DETAILS:case D.SEARCH:case D.SECTION:case D.SUMMARY:case D.LISTING:case D.FIELDSET:case D.BLOCKQUOTE:case D.FIGCAPTION:Jt(e,t);break;case D.LI:es(e);break;case D.DD:case D.DT:ts(e,t);break;case D.H1:case D.H2:case D.H3:case D.H4:case D.H5:case D.H6:ss(e);break;case D.BR:ns(e);break;case D.BODY:zt(e,t);break;case D.HTML:jt(e,t);break;case D.FORM:$t(e);break;case D.APPLET:case D.OBJECT:case D.MARQUEE:as(e,t);break;case D.TEMPLATE:rt(e,t);break;default:rs(e,t)}}function os(e,t){e.tmplInsertionModeStack.length>0?Qs(e,t):qe(e,t)}function cs(e,t){var s;t.tagID===D.SCRIPT&&((s=e.scriptHandler)===null||s===void 0?void 0:s.call(e,e.openElements.current));e.openElements.pop();e.insertionMode=e.originalInsertionMode}function Es(e,t){e._err(t,l.eofInElementThatCanContainOnlyText);e.openElements.pop();e.insertionMode=e.originalInsertionMode;e.onEof(t)}function Ts(e,t){if(e.openElements.currentTagId!==void 0&&Ue.has(e.openElements.currentTagId)){e.pendingCharacterTokens.length=0;e.hasNonWhitespacePendingCharacterToken=false;e.originalInsertionMode=e.insertionMode;e.insertionMode=Fe.IN_TABLE_TEXT;switch(t.type){case p.CHARACTER:Ds(e,t);break;case p.WHITESPACE_CHARACTER:Ss(e,t);break}}else Cs(e,t)}function _s(e,t){e.openElements.clearBackToTableContext();e.activeFormattingElements.insertMarker();e._insertElement(t,d.HTML);e.insertionMode=Fe.IN_CAPTION}function hs(e,t){e.openElements.clearBackToTableContext();e._insertElement(t,d.HTML);e.insertionMode=Fe.IN_COLUMN_GROUP}function As(e,t){e.openElements.clearBackToTableContext();e._insertFakeElement(S.COLGROUP,D.COLGROUP);e.insertionMode=Fe.IN_COLUMN_GROUP;ks(e,t)}function ls(e,t){e.openElements.clearBackToTableContext();e._insertElement(t,d.HTML);e.insertionMode=Fe.IN_TABLE_BODY}function ms(e,t){e.openElements.clearBackToTableContext();e._insertFakeElement(S.TBODY,D.TBODY);e.insertionMode=Fe.IN_TABLE_BODY;gs(e,t)}function ps(e,t){if(e.openElements.hasInTableScope(D.TABLE)){e.openElements.popUntilTagNamePopped(D.TABLE);e._resetInsertionMode();e._processStartTag(t)}}function Is(e,t){bt(t)?e._appendElement(t,d.HTML):Cs(e,t);t.ackSelfClosing=true}function Ns(e,t){if(!e.formElement&&e.openElements.tmplCount===0){e._insertElement(t,d.HTML);e.formElement=e.openElements.current;e.openElements.pop()}}function ds(e,t){switch(t.tagID){case D.TD:case D.TH:case D.TR:ms(e,t);break;case D.STYLE:case D.SCRIPT:case D.TEMPLATE:at(e,t);break;case D.COL:As(e,t);break;case D.FORM:Ns(e,t);break;case D.TABLE:ps(e,t);break;case D.TBODY:case D.TFOOT:case D.THEAD:ls(e,t);break;case D.INPUT:Is(e,t);break;case D.CAPTION:_s(e,t);break;case D.COLGROUP:hs(e,t);break;default:Cs(e,t)}}function us(e,t){switch(t.tagID){case D.TABLE:if(e.openElements.hasInTableScope(D.TABLE)){e.openElements.popUntilTagNamePopped(D.TABLE);e._resetInsertionMode()}break;case D.TEMPLATE:rt(e,t);break;case D.BODY:case D.CAPTION:case D.COL:case D.COLGROUP:case D.HTML:case D.TBODY:case D.TD:case D.TFOOT:case D.TH:case D.THEAD:case D.TR:break;default:Cs(e,t)}}function Cs(e,t){const s=e.fosterParentingEnabled;e.fosterParentingEnabled=true;At(e,t);e.fosterParentingEnabled=s}function Ss(e,t){e.pendingCharacterTokens.push(t)}function Ds(e,t){e.pendingCharacterTokens.push(t);e.hasNonWhitespacePendingCharacterToken=true}function Os(e,t){let s=0;if(e.hasNonWhitespacePendingCharacterToken)for(;s<e.pendingCharacterTokens.length;s++)Cs(e,e.pendingCharacterTokens[s]);else for(;s<e.pendingCharacterTokens.length;s++)e._insertCharacters(e.pendingCharacterTokens[s]);e.insertionMode=e.originalInsertionMode;e._processToken(t)}const Rs=new Set([D.CAPTION,D.COL,D.COLGROUP,D.TBODY,D.TD,D.TFOOT,D.TH,D.THEAD,D.TR]);function fs(e,t){const s=t.tagID;if(Rs.has(s)){if(e.openElements.hasInTableScope(D.CAPTION)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(D.CAPTION);e.activeFormattingElements.clearToLastMarker();e.insertionMode=Fe.IN_TABLE;ds(e,t)}}else qt(e,t)}function Ls(e,t){const s=t.tagID;switch(s){case D.CAPTION:case D.TABLE:if(e.openElements.hasInTableScope(D.CAPTION)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(D.CAPTION);e.activeFormattingElements.clearToLastMarker();e.insertionMode=Fe.IN_TABLE;s===D.TABLE&&us(e,t)}break;case D.BODY:case D.COL:case D.COLGROUP:case D.HTML:case D.TBODY:case D.TD:case D.TFOOT:case D.TH:case D.THEAD:case D.TR:break;default:is(e,t)}}function ks(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.COL:e._appendElement(t,d.HTML);t.ackSelfClosing=true;break;case D.TEMPLATE:at(e,t);break;default:Ps(e,t)}}function Ms(e,t){switch(t.tagID){case D.COLGROUP:if(e.openElements.currentTagId===D.COLGROUP){e.openElements.pop();e.insertionMode=Fe.IN_TABLE}break;case D.TEMPLATE:rt(e,t);break;case D.COL:break;default:Ps(e,t)}}function Ps(e,t){if(e.openElements.currentTagId===D.COLGROUP){e.openElements.pop();e.insertionMode=Fe.IN_TABLE;e._processToken(t)}}function gs(e,t){switch(t.tagID){case D.TR:e.openElements.clearBackToTableBodyContext();e._insertElement(t,d.HTML);e.insertionMode=Fe.IN_ROW;break;case D.TH:case D.TD:e.openElements.clearBackToTableBodyContext();e._insertFakeElement(S.TR,D.TR);e.insertionMode=Fe.IN_ROW;Bs(e,t);break;case D.CAPTION:case D.COL:case D.COLGROUP:case D.TBODY:case D.TFOOT:case D.THEAD:if(e.openElements.hasTableBodyContextInTableScope()){e.openElements.clearBackToTableBodyContext();e.openElements.pop();e.insertionMode=Fe.IN_TABLE;ds(e,t)}break;default:ds(e,t)}}function bs(e,t){const s=t.tagID;switch(t.tagID){case D.TBODY:case D.TFOOT:case D.THEAD:if(e.openElements.hasInTableScope(s)){e.openElements.clearBackToTableBodyContext();e.openElements.pop();e.insertionMode=Fe.IN_TABLE}break;case D.TABLE:if(e.openElements.hasTableBodyContextInTableScope()){e.openElements.clearBackToTableBodyContext();e.openElements.pop();e.insertionMode=Fe.IN_TABLE;us(e,t)}break;case D.BODY:case D.CAPTION:case D.COL:case D.COLGROUP:case D.HTML:case D.TD:case D.TH:case D.TR:break;default:us(e,t)}}function Bs(e,t){switch(t.tagID){case D.TH:case D.TD:e.openElements.clearBackToTableRowContext();e._insertElement(t,d.HTML);e.insertionMode=Fe.IN_CELL;e.activeFormattingElements.insertMarker();break;case D.CAPTION:case D.COL:case D.COLGROUP:case D.TBODY:case D.TFOOT:case D.THEAD:case D.TR:if(e.openElements.hasInTableScope(D.TR)){e.openElements.clearBackToTableRowContext();e.openElements.pop();e.insertionMode=Fe.IN_TABLE_BODY;gs(e,t)}break;default:ds(e,t)}}function Fs(e,t){switch(t.tagID){case D.TR:if(e.openElements.hasInTableScope(D.TR)){e.openElements.clearBackToTableRowContext();e.openElements.pop();e.insertionMode=Fe.IN_TABLE_BODY}break;case D.TABLE:if(e.openElements.hasInTableScope(D.TR)){e.openElements.clearBackToTableRowContext();e.openElements.pop();e.insertionMode=Fe.IN_TABLE_BODY;bs(e,t)}break;case D.TBODY:case D.TFOOT:case D.THEAD:if(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(D.TR)){e.openElements.clearBackToTableRowContext();e.openElements.pop();e.insertionMode=Fe.IN_TABLE_BODY;bs(e,t)}break;case D.BODY:case D.CAPTION:case D.COL:case D.COLGROUP:case D.HTML:case D.TD:case D.TH:break;default:us(e,t)}}function Hs(e,t){const s=t.tagID;if(Rs.has(s)){if(e.openElements.hasInTableScope(D.TD)||e.openElements.hasInTableScope(D.TH)){e._closeTableCell();Bs(e,t)}}else qt(e,t)}function Us(e,t){const s=t.tagID;switch(s){case D.TD:case D.TH:if(e.openElements.hasInTableScope(s)){e.openElements.generateImpliedEndTags();e.openElements.popUntilTagNamePopped(s);e.activeFormattingElements.clearToLastMarker();e.insertionMode=Fe.IN_ROW}break;case D.TABLE:case D.TBODY:case D.TFOOT:case D.THEAD:case D.TR:if(e.openElements.hasInTableScope(s)){e._closeTableCell();Fs(e,t)}break;case D.BODY:case D.CAPTION:case D.COL:case D.COLGROUP:case D.HTML:break;default:is(e,t)}}function Gs(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.OPTION:e.openElements.currentTagId===D.OPTION&&e.openElements.pop();e._insertElement(t,d.HTML);break;case D.OPTGROUP:e.openElements.currentTagId===D.OPTION&&e.openElements.pop();e.openElements.currentTagId===D.OPTGROUP&&e.openElements.pop();e._insertElement(t,d.HTML);break;case D.HR:e.openElements.currentTagId===D.OPTION&&e.openElements.pop();e.openElements.currentTagId===D.OPTGROUP&&e.openElements.pop();e._appendElement(t,d.HTML);t.ackSelfClosing=true;break;case D.INPUT:case D.KEYGEN:case D.TEXTAREA:case D.SELECT:if(e.openElements.hasInSelectScope(D.SELECT)){e.openElements.popUntilTagNamePopped(D.SELECT);e._resetInsertionMode();t.tagID!==D.SELECT&&e._processStartTag(t)}break;case D.SCRIPT:case D.TEMPLATE:at(e,t);break;default:}}function ys(e,t){switch(t.tagID){case D.OPTGROUP:e.openElements.stackTop>0&&e.openElements.currentTagId===D.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===D.OPTGROUP&&e.openElements.pop();e.openElements.currentTagId===D.OPTGROUP&&e.openElements.pop();break;case D.OPTION:e.openElements.currentTagId===D.OPTION&&e.openElements.pop();break;case D.SELECT:if(e.openElements.hasInSelectScope(D.SELECT)){e.openElements.popUntilTagNamePopped(D.SELECT);e._resetInsertionMode()}break;case D.TEMPLATE:rt(e,t);break;default:}}function Ys(e,t){const s=t.tagID;if(s===D.CAPTION||s===D.TABLE||s===D.TBODY||s===D.TFOOT||s===D.THEAD||s===D.TR||s===D.TD||s===D.TH){e.openElements.popUntilTagNamePopped(D.SELECT);e._resetInsertionMode();e._processStartTag(t)}else Gs(e,t)}function ws(e,t){const s=t.tagID;if(s===D.CAPTION||s===D.TABLE||s===D.TBODY||s===D.TFOOT||s===D.THEAD||s===D.TR||s===D.TD||s===D.TH){if(e.openElements.hasInTableScope(s)){e.openElements.popUntilTagNamePopped(D.SELECT);e._resetInsertionMode();e.onEndTag(t)}}else ys(e,t)}function xs(e,t){switch(t.tagID){case D.BASE:case D.BASEFONT:case D.BGSOUND:case D.LINK:case D.META:case D.NOFRAMES:case D.SCRIPT:case D.STYLE:case D.TEMPLATE:case D.TITLE:at(e,t);break;case D.CAPTION:case D.COLGROUP:case D.TBODY:case D.TFOOT:case D.THEAD:e.tmplInsertionModeStack[0]=Fe.IN_TABLE;e.insertionMode=Fe.IN_TABLE;ds(e,t);break;case D.COL:e.tmplInsertionModeStack[0]=Fe.IN_COLUMN_GROUP;e.insertionMode=Fe.IN_COLUMN_GROUP;ks(e,t);break;case D.TR:e.tmplInsertionModeStack[0]=Fe.IN_TABLE_BODY;e.insertionMode=Fe.IN_TABLE_BODY;gs(e,t);break;case D.TD:case D.TH:e.tmplInsertionModeStack[0]=Fe.IN_ROW;e.insertionMode=Fe.IN_ROW;Bs(e,t);break;default:e.tmplInsertionModeStack[0]=Fe.IN_BODY;e.insertionMode=Fe.IN_BODY;qt(e,t)}}function vs(e,t){t.tagID===D.TEMPLATE&&rt(e,t)}function Qs(e,t){if(e.openElements.tmplCount>0){e.openElements.popUntilTagNamePopped(D.TEMPLATE);e.activeFormattingElements.clearToLastMarker();e.tmplInsertionModeStack.shift();e._resetInsertionMode();e.onEof(t)}else qe(e,t)}function Ws(e,t){t.tagID===D.HTML?qt(e,t):Xs(e,t)}function Ks(e,t){var s;if(t.tagID===D.HTML){e.fragmentContext||(e.insertionMode=Fe.AFTER_AFTER_BODY);if(e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===D.HTML){e._setEndLocation(e.openElements.items[0],t);const a=e.openElements.items[1];a&&!((s=e.treeAdapter.getNodeSourceCodeLocation(a))===null||s===void 0?void 0:s.endTag)&&e._setEndLocation(a,t)}}else Xs(e,t)}function Xs(e,t){e.insertionMode=Fe.IN_BODY;At(e,t)}function Vs(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.FRAMESET:e._insertElement(t,d.HTML);break;case D.FRAME:e._appendElement(t,d.HTML);t.ackSelfClosing=true;break;case D.NOFRAMES:at(e,t);break;default:}}function qs(e,t){if(t.tagID===D.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()){e.openElements.pop();e.fragmentContext||e.openElements.currentTagId===D.FRAMESET||(e.insertionMode=Fe.AFTER_FRAMESET)}}function zs(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.NOFRAMES:at(e,t);break;default:}}function js(e,t){t.tagID===D.HTML&&(e.insertionMode=Fe.AFTER_AFTER_FRAMESET)}function Js(e,t){t.tagID===D.HTML?qt(e,t):$s(e,t)}function $s(e,t){e.insertionMode=Fe.IN_BODY;At(e,t)}function Zs(e,t){switch(t.tagID){case D.HTML:qt(e,t);break;case D.NOFRAMES:at(e,t);break;default:}}function ea(e,t){t.chars=i;e._insertCharacters(t)}function ta(e,t){e._insertCharacters(t);e.framesetOk=false}function sa(e){while(e.treeAdapter.getNamespaceURI(e.openElements.current)!==d.HTML&&e.openElements.currentTagId!==void 0&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current))e.openElements.pop()}function aa(e,t){if(Se(t)){sa(e);e._startTagOutsideForeignContent(t)}else{const s=e._getAdjustedCurrentElement();const a=e.treeAdapter.getNamespaceURI(s);if(a===d.MATHML)De(t);else if(a===d.SVG){fe(t);Oe(t)}Re(t);t.selfClosing?e._appendElement(t,a):e._insertElement(t,a);t.ackSelfClosing=true}}function na(e,t){if(t.tagID!==D.P&&t.tagID!==D.BR)for(let s=e.openElements.stackTop;s>0;s--){const a=e.openElements.items[s];if(e.treeAdapter.getNamespaceURI(a)===d.HTML){e._endTagOutsideForeignContent(t);break}const n=e.treeAdapter.getTagName(a);if(n.toLowerCase()===t.tagName){t.tagName=n;e.openElements.shortenToLength(s);break}}else{sa(e);e._endTagOutsideForeignContent(t)}}const ra=new Set([S.AREA,S.BASE,S.BASEFONT,S.BGSOUND,S.BR,S.COL,S.EMBED,S.FRAME,S.HR,S.IMG,S.INPUT,S.KEYGEN,S.LINK,S.META,S.PARAM,S.SOURCE,S.TRACK,S.WBR]);function ia(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===d.HTML&&ra.has(t.treeAdapter.getTagName(e))}const oa={treeAdapter:ae,scriptingEnabled:true};
/**
 * Serializes an AST node to an HTML string.
 *
 * @example
 *
 * ```js
 * const parse5 = require('parse5');
 *
 * const document = parse5.parse('<!DOCTYPE html><html><head></head><body>Hi there!</body></html>');
 *
 * // Serializes a document.
 * const html = parse5.serialize(document);
 *
 * // Serializes the <html> element content.
 * const str = parse5.serialize(document.childNodes[1]);
 *
 * console.log(str); //> '<head></head><body>Hi there!</body>'
 * ```
 *
 * @param node Node to serialize.
 * @param options Serialization options.
 */function ca(e,t){const s={...oa,...t};return ia(e,s)?"":Ta(e,s)}
/**
 * Serializes an AST element node to an HTML string, including the element node.
 *
 * @example
 *
 * ```js
 * const parse5 = require('parse5');
 *
 * const document = parse5.parseFragment('<div>Hello, <b>world</b>!</div>');
 *
 * // Serializes the <div> element.
 * const str = parse5.serializeOuter(document.childNodes[0]);
 *
 * console.log(str); //> '<div>Hello, <b>world</b>!</div>'
 * ```
 *
 * @param node Node to serialize.
 * @param options Serialization options.
 */function Ea(e,t){const s={...oa,...t};return _a(e,s)}function Ta(e,t){let s="";const a=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===S.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===d.HTML?t.treeAdapter.getTemplateContent(e):e;const n=t.treeAdapter.getChildNodes(a);if(n)for(const e of n)s+=_a(e,t);return s}function _a(e,t){return t.treeAdapter.isElementNode(e)?ha(e,t):t.treeAdapter.isTextNode(e)?la(e,t):t.treeAdapter.isCommentNode(e)?ma(e,t):t.treeAdapter.isDocumentTypeNode(e)?pa(e,t):""}function ha(e,t){const s=t.treeAdapter.getTagName(e);return`<${s}${Aa(e,t)}>${ia(e,t)?"":`${Ta(e,t)}</${s}>`}`}function Aa(e,{treeAdapter:t}){let s="";for(const n of t.getAttrList(e)){s+=" ";if(n.namespace)switch(n.namespace){case d.XML:s+=`xml:${n.name}`;break;case d.XMLNS:n.name!=="xmlns"&&(s+="xmlns:");s+=n.name;break;case d.XLINK:s+=`xlink:${n.name}`;break;default:s+=`${n.prefix}:${n.name}`}else s+=n.name;s+=`="${a(n.value)}"`}return s}function la(e,t){const{treeAdapter:s}=t;const a=s.getTextNodeContent(e);const r=s.getParentNode(e);const i=r&&s.isElementNode(r)&&s.getTagName(r);return i&&s.getNamespaceURI(r)===d.HTML&&P(i,t.scriptingEnabled)?a:n(a)}function ma(e,{treeAdapter:t}){return`\x3c!--${t.getCommentNodeContent(e)}--\x3e`}function pa(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}
/**
 * Parses an HTML string.
 *
 * @param html Input HTML string.
 * @param options Parsing options.
 * @returns Document
 *
 * @example
 *
 * ```js
 * const parse5 = require('parse5');
 *
 * const document = parse5.parse('<!DOCTYPE html><html><head></head><body>Hi there!</body></html>');
 *
 * console.log(document.childNodes[1].tagName); //> 'html'
 *```
 */function Ia(e,t){return Parser.parse(e,t)}function Na(e,t,s){if(typeof e==="string"){s=t;t=e;e=null}const a=Parser.getFragmentParser(e,s);a.tokenizer.write(t,true);return a.getFragment()}export{l as ErrorCodes,Parser,N as Token,Tokenizer,B as TokenizerMode,ae as defaultTreeAdapter,Pe as foreignContent,g as html,Ia as parse,Na as parseFragment,ca as serialize,Ea as serializeOuter};

